
/*
   YARA Rule Set
   Author: resteex
   Identifier: malware_sample_library_APT34_Iranian 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_malware_sample_library_APT34_Iranian {
	meta: 
		 description= "malware_sample_library_APT34_Iranian Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-20_23-29-21" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "002afb08d60346b78cb70d829b74eb5f"
		 hash2= "005206e61aa1dceefcf287a9a2860e30"
		 hash3= "059c7e00990385ed7f0923d89e7c8645"
		 hash4= "0d38306c9d22bdbfde4490ba075df131"
		 hash5= "10d12a4363a4ca5cb369edd4d6df108e"
		 hash6= "13fb0522fcc9bb5b17fd1f3da4823175"
		 hash7= "1eb5e28751e9725c0a87c1ed1e9eefd9"
		 hash8= "2585128a3ebca4e657a4ba612eb47ead"
		 hash9= "281b3047c993238aada1daf0f0743a2d"
		 hash10= "36e6e37388e07e0bb7f79d85816b5053"
		 hash11= "370745de5bb80c33e2553e5c2916b98f"
		 hash12= "380aae556a118e4bb7be3be93ec5520d"
		 hash13= "3b3874c26ff8e388e849e5e147e76a6d"
		 hash14= "46a3417b9a6dc9112b0b6becc4be9eb6"
		 hash15= "47a7c027098ba12103e4a37f3be72c62"
		 hash16= "495cab091a699f2b3c9d82a6d72d80d0"
		 hash17= "4a5b116fd7543b1924996218fb732bf4"
		 hash18= "4b92597fc4004ab673e8ba506ed9dceb"
		 hash19= "4f3672ec2ce751dc3f92bb9913474b4c"
		 hash20= "5ecbfd28cc839d8eeb5d0aea30ae8dee"
		 hash21= "66c151f826b314c57efc6c9b80eea694"
		 hash22= "67099c949502839f5969134baad862b2"
		 hash23= "746fff5075b9890269e02a1f7296253b"
		 hash24= "7a6a2b83516e60bb19e2a7a27a34ec98"
		 hash25= "849e23239a30c3fb9ccd26cc78276c97"
		 hash26= "8702898f061cbc6ecfff40be8b1b7553"
		 hash27= "8a45f9c7a565e3cc0a68a4e843df575f"
		 hash28= "8bb1e5f5e3ce8f8bfffe1eb61e0617ca"
		 hash29= "959a229f8e9aeb31dc3c8743115ec5a9"
		 hash30= "95f78727cbe50d398974d455761d8d49"
		 hash31= "a0f7a62bb9c4a8ade97b193926334678"
		 hash32= "a7c58407067f77ddf71764e4f06d70f5"
		 hash33= "abe85975850ee1715a177e08fd1a0d7e"
		 hash34= "b8a6590c313c38a619e11d76865dc136"
		 hash35= "bf8096f6a948a02366ef4592c1a59f96"
		 hash36= "cc9036a199dcd7e19971cbe3c16a70c5"
		 hash37= "d4d28c4eb6d92ca453c51c7d7e143bcc"
		 hash38= "e0f8f22f247d90214639b396523b347e"
		 hash39= "e5a33fc317d21a6c788ee4689f180902"
		 hash40= "e6594128f9658ededbd892cb3e3b9267"
		 hash41= "ee7b1b428cd840205bd1daac53d4316b"
		 hash42= "efc38dd147b9462134af5635f7709145"
		 hash43= "f75b8653f10ea00ebd55a6486f82bd0f"
		 hash44= "fc5b4fa65ee6f2b67f36f4681771e7e8"

	strings:

	
 		 $s1= "DocumentSummaryInformation" fullword wide
		 $s2= "Project.ThisDocument.AutoOpen" fullword wide
		 $a1= "https://114.198.235.22/owa/auth/login.aspx,mail.its.ws,Samoa" fullword ascii
		 $a2= "https://1.202.179.13/owa/auth/error1.aspx,mail.cecep.cn,China" fullword ascii
		 $a3= "https://1.202.179.14/owa/auth/error1.aspx,mail.cecep.cn,China" fullword ascii
		 $a4= "https://180.169.13.230/owa/auth/error1.aspx,bdo.com.cn,China" fullword ascii
		 $a5= "https://200.33.162.13/owa/auth/error3.aspx,sre.gob.mx,Mexico" fullword ascii
		 $a6= "https://202.183.235.4/owa/auth/signout.aspx,rtarf.mi.th,Thailand" fullword ascii
		 $a7= "https://202.70.34.68/owa/auth/error0.aspx,mfa.gov.mn,Myanmar" fullword ascii
		 $a8= "https://202.70.34.68/owa/auth/error1.aspx,mifa.gov.mn,Myanmar" fullword ascii
		 $a9= "https://213.189.82.221/owa/auth/errorff.aspx,cait.gov.kw,Kuwait" fullword ascii
		 $a10= "https://59.124.43.229/owa/auth/error0.aspx,tgpf.org.tw,Taiwan" fullword ascii
		 $a11= "https://77.42.251.125/owa/auth/logout.aspx,{ul.edu.lb},Lebanon" fullword ascii
		 $a12= "https://e-albania.al/dptaktkonstatim.aspx,e-albania.al,Albania" fullword ascii
		 $a13= ">ShellLocal-v8.8.5/HighShellLocal/js/jquery/jquery-3.2.1.min.js" fullword ascii
		 $a14= "ShellLocal-v8.8.5/HighShellLocal/js/semantic/semantic.min.js" fullword ascii
		 $a15= "Webshells_and_Panel/FoxPanel222/FoxPanel/favicon-32x32.pngUT" fullword ascii
		 $a16= "Webshells_and_Panel/FoxPanel222/FoxPanel/FoxPanel.csproj.userUT" fullword ascii
		 $a17= "Webshells_and_Panel/FoxPanel222/FoxPanel/Web.Release.configUT" fullword ascii
		 $a18= "Webshells_and_Panel/HyperShell/ExpiredPasswordTech/error4.aspxUT" fullword ascii
		 $a19= "Webshells_and_Panel/HyperShell/HyperShell/Account/Confirm.aspxUT" fullword ascii
		 $a20= "Webshells_and_Panel/HyperShell/HyperShell/Account/Forgot.aspxUT" fullword ascii
		 $a21= "Webshells_and_Panel/HyperShell/HyperShell/Account/Lockout.aspxUT" fullword ascii
		 $a22= "Webshells_and_Panel/HyperShell/HyperShell/Account/Login.aspxUT" fullword ascii
		 $a23= "Webshells_and_Panel/HyperShell/HyperShell/Account/Manage.aspxUT" fullword ascii
		 $a24= "Webshells_and_Panel/HyperShell/HyperShell/ExpiredPasswordTech/UT" fullword ascii
		 $a25= "Webshells_and_Panel/HyperShell/HyperShell/HighShellPass.txtUT" fullword ascii
		 $a26= "Webshells_and_Panel/HyperShell/HyperShell/Lab/PicMaker.aspx.csUT" fullword ascii
		 $a27= "Webshells_and_Panel/HyperShell/HyperShell/Lab/PicMaker.aspxUT" fullword ascii
		 $a28= "Webshells_and_Panel/HyperShell/HyperShell/Lab/ScreenShot.aspxUT" fullword ascii
		 $a29= "Webshells_and_Panel/HyperShell/HyperShell/Shell/HighShell.aspxUT" fullword ascii
		 $a30= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocalInner/UT" fullword ascii
		 $a31= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocal-Parts/UT" fullword ascii
		 $a32= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocal-Special1/UT" fullword ascii
		 $a33= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocal-Special2/UT" fullword ascii
		 $a34= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocal-Special3/UT" fullword ascii
		 $a35= "Webshells_and_Panel/HyperShell/HyperShell/ShellLocal-Special4/UT" fullword ascii
		 $a36= "Webshells_and_Panel/HyperShell/HyperShell/Shell/simple.aspxUT" fullword ascii
		 $a37= "Webshells_and_Panel/HyperShell/Libraries/Json90r1/license.txtUT" fullword ascii
		 $a38= "Webshells_and_Panel/HyperShell/Libraries/Json90r1/readme.txtUT" fullword ascii
		 $a39= "Webshells_and_Panel/HyperShell/Libraries/Json90r1/Source/Doc/UT" fullword ascii
		 $a40= "Webshells_and_Panel/HyperShell/Libraries/Json90r1/Source/Src/UT" fullword ascii
		 $a41= "Webshells_and_Panel/HyperShell/Libraries/MyDownloader/src/UT" fullword ascii
		 $a42= "Webshells_and_Panel/HyperShell/packages/EntityFramework.6.1.3/UT" fullword ascii
		 $a43= "Webshells_and_Panel/HyperShell/StableVersion/HighShell v5.0/UT" fullword ascii
		 $a44= "Webshells_and_Panel/MinionProject/Minion/bin/Minion.dll.configUT" fullword ascii
		 $a45= "Webshells_and_Panel/MinionProject/Minion/fonts/montserrat/UT" fullword ascii
		 $a46= "Webshells_and_Panel/MinionProject/Minion/HighShellLocal/css/UT" fullword ascii
		 $a47= "Webshells_and_Panel/MinionProject/Minion/HighShellLocal/files/UT" fullword ascii
		 $a48= "Webshells_and_Panel/MinionProject/Minion/HighShellLocal/js/UT" fullword ascii
		 $a49= "Webshells_and_Panel/MinionProject/Minion/images/foxicon.pngUT" fullword ascii
		 $a50= "Webshells_and_Panel/MinionProject/Minion/images/img-01.pngUT" fullword ascii

		 $hex1= {246131303d20226874}
		 $hex2= {246131313d20226874}
		 $hex3= {246131323d20226874}
		 $hex4= {246131333d20223e53}
		 $hex5= {246131343d20225368}
		 $hex6= {246131353d20225765}
		 $hex7= {246131363d20225765}
		 $hex8= {246131373d20225765}
		 $hex9= {246131383d20225765}
		 $hex10= {246131393d20225765}
		 $hex11= {2461313d2022687474}
		 $hex12= {246132303d20225765}
		 $hex13= {246132313d20225765}
		 $hex14= {246132323d20225765}
		 $hex15= {246132333d20225765}
		 $hex16= {246132343d20225765}
		 $hex17= {246132353d20225765}
		 $hex18= {246132363d20225765}
		 $hex19= {246132373d20225765}
		 $hex20= {246132383d20225765}
		 $hex21= {246132393d20225765}
		 $hex22= {2461323d2022687474}
		 $hex23= {246133303d20225765}
		 $hex24= {246133313d20225765}
		 $hex25= {246133323d20225765}
		 $hex26= {246133333d20225765}
		 $hex27= {246133343d20225765}
		 $hex28= {246133353d20225765}
		 $hex29= {246133363d20225765}
		 $hex30= {246133373d20225765}
		 $hex31= {246133383d20225765}
		 $hex32= {246133393d20225765}
		 $hex33= {2461333d2022687474}
		 $hex34= {246134303d20225765}
		 $hex35= {246134313d20225765}
		 $hex36= {246134323d20225765}
		 $hex37= {246134333d20225765}
		 $hex38= {246134343d20225765}
		 $hex39= {246134353d20225765}
		 $hex40= {246134363d20225765}
		 $hex41= {246134373d20225765}
		 $hex42= {246134383d20225765}
		 $hex43= {246134393d20225765}
		 $hex44= {2461343d2022687474}
		 $hex45= {246135303d20225765}
		 $hex46= {2461353d2022687474}
		 $hex47= {2461363d2022687474}
		 $hex48= {2461373d2022687474}
		 $hex49= {2461383d2022687474}
		 $hex50= {2461393d2022687474}
		 $hex51= {2473313d2022446f63}
		 $hex52= {2473323d202250726f}

	condition:
		34 of them
}
