
/*
   YARA Rule Set
   Author: resteex
   Identifier: OSX_XAgent 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_OSX_XAgent {
	meta: 
		 description= "OSX_XAgent Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-20_04-42-44" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "27ff86999bf2cbd5afbad94f8a9bb696"
		 hash2= "4fe4b9560e99e33dabca553e2eeee510"
		 hash3= "fbcfeeacc711310395da6ef87e34a616"

	strings:

	
 		 $a1= "___34-[FTPManager uploadFile:toServer:]_block_invoke" fullword ascii
		 $a2= "___36-[FTPManager deleteFile:fromServer:]_block_invoke" fullword ascii
		 $a3= "___39-[FTPManager createNewFolder:atServer:]_block_invoke" fullword ascii
		 $a4= "___41-[FTPManager chmodFileNamed:to:atServer:]_block_invoke" fullword ascii
		 $a5= "___41-[FTPManager deleteFileNamed:fromServer:]_block_invoke" fullword ascii
		 $a6= "___42+[NSURLConnectionDelegateWrapper wrappers]_block_invoke" fullword ascii
		 $a7= "application:continueUserActivity:restorationHandler:" fullword ascii
		 $a8= "application:didFailToContinueUserActivityWithType:error:" fullword ascii
		 $a9= "application:didFailToRegisterForRemoteNotificationsWithError:" fullword ascii
		 $a10= "application:didRegisterForRemoteNotificationsWithDeviceToken:" fullword ascii
		 $a11= "application:printFiles:withSettings:showPrintPanels:" fullword ascii
		 $a12= "connection:willSendRequestForAuthenticationChallenge:" fullword ascii
		 $a13= "-[FileSystem findFilesAtPath:withMask:andRecursion:]" fullword ascii
		 $a14= "+[FMServer serverWithDestination:username:password:]" fullword ascii
		 $a15= "-[FTPManager _createListingArrayFromDirectoryListingData:]" fullword ascii
		 $a16= "-[FTPManager _downloadFile:toDirectory:fromServer:]" fullword ascii
		 $a17= "-[FTPManager downloadFile:toDirectory:fromServer:]" fullword ascii
		 $a18= "-[FTPManager _streamDidEndWithSuccess:failureReason:]" fullword ascii
		 $a19= "-[HTTPChannel createEncodeData:size_data:size_result_data:]" fullword ascii
		 $a20= "-[HTTPChannel generateHttpMes:data_size:size_http_mes:]" fullword ascii
		 $a21= "-[NSObject(NSObject_SBJsonWriting) JSONRepresentation]" fullword ascii
		 $a22= "-[NSString(FTPManagerNSStringAdditions) ftpURLForPort:]" fullword ascii
		 $a23= "-[NSString(FTPManagerNSStringAdditions) stringWithoutProtocol]" fullword ascii
		 $a24= "-[NSURLConnectionDelegateWrapper connection:didFailWithError:]" fullword ascii
		 $a25= "-[NSURLConnectionDelegateWrapper connectionDidFinishLoading:]" fullword ascii
		 $a26= "-[NSURLConnectionDelegateWrapper connection:didReceiveData:]" fullword ascii
		 $a27= "-[NSURLConnectionDelegateWrapper connection:didReceiveResponse:]" fullword ascii
		 $a28= "-[NSURLConnectionDelegateWrapper connection:willCacheResponse:]" fullword ascii
		 $a29= "+[NSURLConnectionDelegateWrapper wrappers].onceToken" fullword ascii
		 $a30= "+[NSURLConnectionDelegateWrapper wrappers]._wrappers" fullword ascii
		 $a31= "+[NSURLConnectionDelegateWrapper wrapperWithHandler:]" fullword ascii
		 $a32= "_OBJC_CLASS_$_SBJsonStreamParserStateArrayGotValue" fullword ascii
		 $a33= "_OBJC_CLASS_$_SBJsonStreamParserStateArrayNeedValue" fullword ascii
		 $a34= "_OBJC_CLASS_$_SBJsonStreamParserStateObjectGotValue" fullword ascii
		 $a35= "_OBJC_CLASS_$_SBJsonStreamParserStateObjectNeedKey" fullword ascii
		 $a36= "_OBJC_CLASS_$_SBJsonStreamParserStateObjectSeparator" fullword ascii
		 $a37= "_OBJC_IVAR_$_NSURLConnectionDelegateWrapper._connection" fullword ascii
		 $a38= "_OBJC_IVAR_$_NSURLConnectionDelegateWrapper._error" fullword ascii
		 $a39= "_OBJC_IVAR_$_NSURLConnectionDelegateWrapper._handler" fullword ascii
		 $a40= "_OBJC_IVAR_$_NSURLConnectionDelegateWrapper._responseData" fullword ascii
		 $a41= "_OBJC_IVAR_$_NSURLConnectionDelegateWrapper._urlResponse" fullword ascii
		 $a42= "_OBJC_IVAR_$_SBJsonStreamParserAdapter.currentType" fullword ascii
		 $a43= "_OBJC_IVAR_$_SBJsonStreamParserAdapter.levelsToSkip" fullword ascii
		 $a44= "_OBJC_IVAR_$_SBJsonStreamParser.supportMultipleDocuments" fullword ascii
		 $a45= "_OBJC_METACLASS_$_SBJsonStreamParserStateArrayGotValue" fullword ascii
		 $a46= "_OBJC_METACLASS_$_SBJsonStreamParserStateArrayNeedValue" fullword ascii
		 $a47= "_OBJC_METACLASS_$_SBJsonStreamParserStateArrayStart" fullword ascii
		 $a48= "_OBJC_METACLASS_$_SBJsonStreamParserStateObjectGotKey" fullword ascii
		 $a49= "_OBJC_METACLASS_$_SBJsonStreamParserStateObjectGotValue" fullword ascii
		 $a50= "_OBJC_METACLASS_$_SBJsonStreamParserStateObjectNeedKey" fullword ascii
		 $a51= "_OBJC_METACLASS_$_SBJsonStreamParserStateObjectSeparator" fullword ascii
		 $a52= "_OBJC_METACLASS_$_SBJsonStreamParserStateObjectStart" fullword ascii
		 $a53= "_OBJC_METACLASS_$_SBJsonStreamWriterStateArrayStart" fullword ascii
		 $a54= "_OBJC_METACLASS_$_SBJsonStreamWriterStateArrayValue" fullword ascii
		 $a55= "_OBJC_METACLASS_$_SBJsonStreamWriterStateObjectKey" fullword ascii
		 $a56= "_OBJC_METACLASS_$_SBJsonStreamWriterStateObjectStart" fullword ascii
		 $a57= "_OBJC_METACLASS_$_SBJsonStreamWriterStateObjectValue" fullword ascii
		 $a58= "performSelectorOnMainThread:withObject:waitUntilDone:" fullword ascii
		 $a59= "-[SBJsonStreamParserAccumulator parser:foundArray:]" fullword ascii
		 $a60= "-[SBJsonStreamParserAccumulator parser:foundObject:]" fullword ascii
		 $a61= "-[SBJsonStreamParserAdapter parserFoundArrayStart:]" fullword ascii
		 $a62= "-[SBJsonStreamParserAdapter parserFoundObjectEnd:]" fullword ascii
		 $a63= "-[SBJsonStreamParserAdapter parser:foundObjectKey:]" fullword ascii
		 $a64= "-[SBJsonStreamParserAdapter parserFoundObjectStart:]" fullword ascii
		 $a65= "-[SBJsonStreamParser setSupportMultipleDocuments:]" fullword ascii
		 $a66= "+[SBJsonStreamParserStateArrayGotValue sharedInstance]" fullword ascii
		 $a67= "+[SBJsonStreamParserStateArrayGotValue sharedInstance].state" fullword ascii
		 $a68= "+[SBJsonStreamParserStateArrayNeedValue sharedInstance]" fullword ascii
		 $a69= "+[SBJsonStreamParserStateArrayNeedValue sharedInstance].state" fullword ascii
		 $a70= "-[SBJsonStreamParserStateArrayStart parser:shouldAcceptToken:]" fullword ascii
		 $a71= "-[SBJsonStreamParserStateArrayStart parser:shouldTransitionTo:]" fullword ascii
		 $a72= "+[SBJsonStreamParserStateArrayStart sharedInstance]" fullword ascii
		 $a73= "+[SBJsonStreamParserStateArrayStart sharedInstance].state" fullword ascii
		 $a74= "-[SBJsonStreamParserStateComplete parserShouldReturn:]" fullword ascii
		 $a75= "+[SBJsonStreamParserStateComplete sharedInstance].state" fullword ascii
		 $a76= "-[SBJsonStreamParserStateError parserShouldReturn:]" fullword ascii
		 $a77= "+[SBJsonStreamParserStateError sharedInstance].state" fullword ascii
		 $a78= "-[SBJsonStreamParserStateObjectGotKey parser:shouldAcceptToken:]" fullword ascii
		 $a79= "+[SBJsonStreamParserStateObjectGotKey sharedInstance]" fullword ascii
		 $a80= "+[SBJsonStreamParserStateObjectGotKey sharedInstance].state" fullword ascii
		 $a81= "+[SBJsonStreamParserStateObjectGotValue sharedInstance]" fullword ascii
		 $a82= "+[SBJsonStreamParserStateObjectGotValue sharedInstance].state" fullword ascii
		 $a83= "+[SBJsonStreamParserStateObjectNeedKey sharedInstance]" fullword ascii
		 $a84= "+[SBJsonStreamParserStateObjectNeedKey sharedInstance].state" fullword ascii
		 $a85= "+[SBJsonStreamParserStateObjectSeparator sharedInstance]" fullword ascii
		 $a86= "+[SBJsonStreamParserStateObjectSeparator sharedInstance].state" fullword ascii
		 $a87= "-[SBJsonStreamParserStateObjectStart parser:shouldAcceptToken:]" fullword ascii
		 $a88= "-[SBJsonStreamParserStateObjectStart parser:shouldTransitionTo:]" fullword ascii
		 $a89= "+[SBJsonStreamParserStateObjectStart sharedInstance]" fullword ascii
		 $a90= "+[SBJsonStreamParserStateObjectStart sharedInstance].state" fullword ascii
		 $a91= "-[SBJsonStreamParserState parser:shouldAcceptToken:]" fullword ascii
		 $a92= "-[SBJsonStreamParserState parser:shouldTransitionTo:]" fullword ascii
		 $a93= "-[SBJsonStreamParserStateStart parser:shouldAcceptToken:]" fullword ascii
		 $a94= "-[SBJsonStreamParserStateStart parser:shouldTransitionTo:]" fullword ascii
		 $a95= "+[SBJsonStreamParserStateStart sharedInstance].state" fullword ascii
		 $a96= "-[SBJsonStreamWriterAccumulator writer:appendBytes:length:]" fullword ascii
		 $a97= "+[SBJsonStreamWriterStateArrayStart sharedInstance]" fullword ascii
		 $a98= "+[SBJsonStreamWriterStateArrayStart sharedInstance].state" fullword ascii
		 $a99= "-[SBJsonStreamWriterStateArrayStart transitionState:]" fullword ascii
		 $a100= "-[SBJsonStreamWriterStateArrayValue appendSeparator:]" fullword ascii
		 $a101= "+[SBJsonStreamWriterStateArrayValue sharedInstance]" fullword ascii
		 $a102= "+[SBJsonStreamWriterStateArrayValue sharedInstance].state" fullword ascii
		 $a103= "-[SBJsonStreamWriterStateComplete isInvalidState:]" fullword ascii
		 $a104= "+[SBJsonStreamWriterStateComplete sharedInstance].state" fullword ascii
		 $a105= "+[SBJsonStreamWriterStateError sharedInstance].state" fullword ascii
		 $a106= "-[SBJsonStreamWriterStateObjectKey appendSeparator:]" fullword ascii
		 $a107= "+[SBJsonStreamWriterStateObjectKey sharedInstance]" fullword ascii
		 $a108= "+[SBJsonStreamWriterStateObjectKey sharedInstance].state" fullword ascii
		 $a109= "-[SBJsonStreamWriterStateObjectStart expectingKey:]" fullword ascii
		 $a110= "+[SBJsonStreamWriterStateObjectStart sharedInstance]" fullword ascii
		 $a111= "+[SBJsonStreamWriterStateObjectStart sharedInstance].state" fullword ascii
		 $a112= "-[SBJsonStreamWriterStateObjectStart transitionState:]" fullword ascii
		 $a113= "-[SBJsonStreamWriterStateObjectValue appendSeparator:]" fullword ascii
		 $a114= "-[SBJsonStreamWriterStateObjectValue appendWhitespace:]" fullword ascii
		 $a115= "+[SBJsonStreamWriterStateObjectValue sharedInstance]" fullword ascii
		 $a116= "+[SBJsonStreamWriterStateObjectValue sharedInstance].state" fullword ascii
		 $a117= "-[SBJsonStreamWriterStateObjectValue transitionState:]" fullword ascii
		 $a118= "+[SBJsonStreamWriterStateStart sharedInstance].state" fullword ascii
		 $a119= "scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:" fullword ascii
		 $a120= "/System/Library/Frameworks/AppKit.framework/Versions/C/AppKit" fullword ascii
		 $a121= "/System/Library/Frameworks/Carbon.framework/Versions/A/Carbon" fullword ascii
		 $a122= "/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit" fullword ascii
		 $a123= "__ZGVZL17add_image_hook_GCPK11mach_headerlE7patches" fullword ascii
		 $a124= "__ZGVZL18add_image_hook_ARCPK11mach_headerlE7patches" fullword ascii
		 $a125= "__ZGVZL22add_image_hook_swiftV1PK11mach_headerlE3dlh" fullword ascii
		 $a126= "__ZGVZL22add_image_hook_swiftV1PK11mach_headerlE7patches" fullword ascii
		 $a127= "__ZL14initialize_impP11objc_objectP13objc_selector" fullword ascii
		 $a128= "__ZL17transcribeMethodsP10objc_classP15glue_class_ro_t" fullword ascii
		 $a129= "__ZL19patch_lazy_pointersPK11mach_headerP7patch_tm" fullword ascii
		 $a130= "__ZL19transcribeProtocolsP10objc_classP15glue_class_ro_t" fullword ascii
		 $a131= "__ZL20transcribePropertiesP10objc_classP15glue_class_ro_t" fullword ascii
		 $a132= "__ZL24__arclite_object_setIvarP11objc_objectP9objc_ivarS0_" fullword ascii
		 $a133= "__ZL26__arclite_objc_storeStrongPP11objc_objectS0_" fullword ascii
		 $a134= "__ZL32__arclite_objc_allocateClassPairP18glue_swift_class_tPKcm" fullword ascii
		 $a135= "__ZL32__arclite_objc_retainAutoreleaseP11objc_object" fullword ascii
		 $a136= "__ZL32__arclite_object_getIndexedIvarsP11objc_object" fullword ascii
		 $a137= "__ZL36__arclite_object_setInstanceVariableP11objc_objectPKcPv" fullword ascii
		 $a138= "__ZL37__arclite_objc_autoreleaseReturnValueP11objc_object" fullword ascii
		 $a139= "__ZL43__arclite_objc_retainAutoreleaseReturnValueP11objc_object" fullword ascii
		 $a140= "__ZL44__arclite_objc_retainAutoreleasedReturnValueP11objc_object" fullword ascii
		 $a141= "@__ZNKSt3__120__vector_base_commonILb1EE20__throw_length_errorEv" fullword ascii
		 $a142= "__ZNKSt3__120__vector_base_commonILb1EE20__throw_length_errorEv" fullword ascii
		 $a143= "__ZZL18add_image_hook_ARCPK11mach_headerlE7patches" fullword ascii
		 $a144= "__ZZL22add_image_hook_swiftV1PK11mach_headerlE3dlh" fullword ascii
		 $a145= "__ZZL22add_image_hook_swiftV1PK11mach_headerlE7patches" fullword ascii

		 $hex1= {24613130303d20222d}
		 $hex2= {24613130313d20222b}
		 $hex3= {24613130323d20222b}
		 $hex4= {24613130333d20222d}
		 $hex5= {24613130343d20222b}
		 $hex6= {24613130353d20222b}
		 $hex7= {24613130363d20222d}
		 $hex8= {24613130373d20222b}
		 $hex9= {24613130383d20222b}
		 $hex10= {24613130393d20222d}
		 $hex11= {246131303d20226170}
		 $hex12= {24613131303d20222b}
		 $hex13= {24613131313d20222b}
		 $hex14= {24613131323d20222d}
		 $hex15= {24613131333d20222d}
		 $hex16= {24613131343d20222d}
		 $hex17= {24613131353d20222b}
		 $hex18= {24613131363d20222b}
		 $hex19= {24613131373d20222d}
		 $hex20= {24613131383d20222b}
		 $hex21= {24613131393d202273}
		 $hex22= {246131313d20226170}
		 $hex23= {24613132303d20222f}
		 $hex24= {24613132313d20222f}
		 $hex25= {24613132323d20222f}
		 $hex26= {24613132333d20225f}
		 $hex27= {24613132343d20225f}
		 $hex28= {24613132353d20225f}
		 $hex29= {24613132363d20225f}
		 $hex30= {24613132373d20225f}
		 $hex31= {24613132383d20225f}
		 $hex32= {24613132393d20225f}
		 $hex33= {246131323d2022636f}
		 $hex34= {24613133303d20225f}
		 $hex35= {24613133313d20225f}
		 $hex36= {24613133323d20225f}
		 $hex37= {24613133333d20225f}
		 $hex38= {24613133343d20225f}
		 $hex39= {24613133353d20225f}
		 $hex40= {24613133363d20225f}
		 $hex41= {24613133373d20225f}
		 $hex42= {24613133383d20225f}
		 $hex43= {24613133393d20225f}
		 $hex44= {246131333d20222d5b}
		 $hex45= {24613134303d20225f}
		 $hex46= {24613134313d202240}
		 $hex47= {24613134323d20225f}
		 $hex48= {24613134333d20225f}
		 $hex49= {24613134343d20225f}
		 $hex50= {24613134353d20225f}
		 $hex51= {246131343d20222b5b}
		 $hex52= {246131353d20222d5b}
		 $hex53= {246131363d20222d5b}
		 $hex54= {246131373d20222d5b}
		 $hex55= {246131383d20222d5b}
		 $hex56= {246131393d20222d5b}
		 $hex57= {2461313d20225f5f5f}
		 $hex58= {246132303d20222d5b}
		 $hex59= {246132313d20222d5b}
		 $hex60= {246132323d20222d5b}
		 $hex61= {246132333d20222d5b}
		 $hex62= {246132343d20222d5b}
		 $hex63= {246132353d20222d5b}
		 $hex64= {246132363d20222d5b}
		 $hex65= {246132373d20222d5b}
		 $hex66= {246132383d20222d5b}
		 $hex67= {246132393d20222b5b}
		 $hex68= {2461323d20225f5f5f}
		 $hex69= {246133303d20222b5b}
		 $hex70= {246133313d20222b5b}
		 $hex71= {246133323d20225f4f}
		 $hex72= {246133333d20225f4f}
		 $hex73= {246133343d20225f4f}
		 $hex74= {246133353d20225f4f}
		 $hex75= {246133363d20225f4f}
		 $hex76= {246133373d20225f4f}
		 $hex77= {246133383d20225f4f}
		 $hex78= {246133393d20225f4f}
		 $hex79= {2461333d20225f5f5f}
		 $hex80= {246134303d20225f4f}
		 $hex81= {246134313d20225f4f}
		 $hex82= {246134323d20225f4f}
		 $hex83= {246134333d20225f4f}
		 $hex84= {246134343d20225f4f}
		 $hex85= {246134353d20225f4f}
		 $hex86= {246134363d20225f4f}
		 $hex87= {246134373d20225f4f}
		 $hex88= {246134383d20225f4f}
		 $hex89= {246134393d20225f4f}
		 $hex90= {2461343d20225f5f5f}
		 $hex91= {246135303d20225f4f}
		 $hex92= {246135313d20225f4f}
		 $hex93= {246135323d20225f4f}
		 $hex94= {246135333d20225f4f}
		 $hex95= {246135343d20225f4f}
		 $hex96= {246135353d20225f4f}
		 $hex97= {246135363d20225f4f}
		 $hex98= {246135373d20225f4f}
		 $hex99= {246135383d20227065}
		 $hex100= {246135393d20222d5b}
		 $hex101= {2461353d20225f5f5f}
		 $hex102= {246136303d20222d5b}
		 $hex103= {246136313d20222d5b}
		 $hex104= {246136323d20222d5b}
		 $hex105= {246136333d20222d5b}
		 $hex106= {246136343d20222d5b}
		 $hex107= {246136353d20222d5b}
		 $hex108= {246136363d20222b5b}
		 $hex109= {246136373d20222b5b}
		 $hex110= {246136383d20222b5b}
		 $hex111= {246136393d20222b5b}
		 $hex112= {2461363d20225f5f5f}
		 $hex113= {246137303d20222d5b}
		 $hex114= {246137313d20222d5b}
		 $hex115= {246137323d20222b5b}
		 $hex116= {246137333d20222b5b}
		 $hex117= {246137343d20222d5b}
		 $hex118= {246137353d20222b5b}
		 $hex119= {246137363d20222d5b}
		 $hex120= {246137373d20222b5b}
		 $hex121= {246137383d20222d5b}
		 $hex122= {246137393d20222b5b}
		 $hex123= {2461373d2022617070}
		 $hex124= {246138303d20222b5b}
		 $hex125= {246138313d20222b5b}
		 $hex126= {246138323d20222b5b}
		 $hex127= {246138333d20222b5b}
		 $hex128= {246138343d20222b5b}
		 $hex129= {246138353d20222b5b}
		 $hex130= {246138363d20222b5b}
		 $hex131= {246138373d20222d5b}
		 $hex132= {246138383d20222d5b}
		 $hex133= {246138393d20222b5b}
		 $hex134= {2461383d2022617070}
		 $hex135= {246139303d20222b5b}
		 $hex136= {246139313d20222d5b}
		 $hex137= {246139323d20222d5b}
		 $hex138= {246139333d20222d5b}
		 $hex139= {246139343d20222d5b}
		 $hex140= {246139353d20222b5b}
		 $hex141= {246139363d20222d5b}
		 $hex142= {246139373d20222b5b}
		 $hex143= {246139383d20222b5b}
		 $hex144= {246139393d20222d5b}
		 $hex145= {2461393d2022617070}

	condition:
		96 of them
}
