
/*
   YARA Rule Set
   Author: resteex
   Identifier: DCRat 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_DCRat {
	meta: 
		 description= "DCRat Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-15_00-02-20" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "025822f990579ddd47d94b66072d9c70"
		 hash2= "1920fb0bedf699e403416cc15962c57a"
		 hash3= "2248fa599635664dad22d456b4946073"
		 hash4= "8d09a913eda90188353e6d640ab71a63"
		 hash5= "aafc3c89ab0b115092416160141397f3"
		 hash6= "ade2c9a6a55df66e1d0245f6a29f8766"
		 hash7= "c49b3f311acc59e9c99b55c2ada71002"

	strings:

	
 		 $s1= "=(?:[^']*'[^']*')*'[^']*)" fullword wide
		 $s2= "=(?:[^']*'[^']*')*[^']*)" fullword wide
		 $s3= "(?=(?:[^']*'[^']*')*[^']*$)" fullword wide
		 $s4= "(?=[^']*'(?:[^']*'[^']*')*[^']*$)" fullword wide
		 $s5= "^(.*/)?([^/\\.]+/\\.\\./)(.+)$" fullword wide
		 $s6= "{0}[{1}][{2}], pos=0x{3:X})" fullword wide
		 $s7= "111ea8cd-b62a-4bdb-89f6-67ffcdc2458b" fullword wide
		 $s8= "1aab75c8-cfef-451c-ab95-ac034b8e1731" fullword wide
		 $s9= "20332624-fb0d-4d9e-bd0d-cbf6786c102e" fullword wide
		 $s10= "2fb866ac-b078-4942-ab6c-003d05cda674" fullword wide
		 $s11= "314ffbae-5b41-4c95-9c19-4e7d586face3" fullword wide
		 $s12= "322de230-9eeb-43bd-ab7a-ff412251541d" fullword wide
		 $s13= "33026ee0-e387-4582-ae0a-34a2ad3baa18" fullword wide
		 $s14= "34e6e728-06d6-4491-a553-4795650db912" fullword wide
		 $s15= "37e48bf5-645e-4c5b-89de-ada9e29b696a" fullword wide
		 $s16= "3afd0cee-18f2-4ba5-a110-8bea502e1f92" fullword wide
		 $s17= "4276c9b1-759d-4bf3-9cd0-0d723d138f96" fullword wide
		 $s18= "*(,(-(43EDGFPOTSVUXWa`cbedfdgdhdjinmompmqmwvxvzy|{~}" fullword wide
		 $s19= "%4d-%02d-%02d-%02d-%02d-%02d-%03d" fullword wide
		 $s20= "53004909-1ef5-46d7-a18e-5a75f8b5905f" fullword wide
		 $s21= "543186e4-4649-4e65-b588-4aa352aff379" fullword wide
		 $s22= "5faeeae7-0290-4c31-9e8a-c534f68d9dba" fullword wide
		 $s23= "6821c42b-65a4-4e82-99bc-9a88205ecd0c" fullword wide
		 $s24= "6c990d31-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s25= "6c990d32-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s26= "6c990d33-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s27= "6c990d34-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s28= "6c990d35-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s29= "6c990d36-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s30= "6c990d37-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s31= "6c990d38-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s32= "6c990d39-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s33= "6c990d3a-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s34= "6c990d3b-bb8e-477a-8598-0d5d96fcd88a" fullword wide
		 $s35= "71eeb820-a59f-4de2-bcec-38db1dd611a4" fullword wide
		 $s36= "73d1072d-1870-4174-a063-29ff4ff6c11e" fullword wide
		 $s37= "7632f0e6-9538-4d61-acda-ea29c8c14456" fullword wide
		 $s38= "7e700499-396a-49ee-b1b4-f628021e8c9d" fullword wide
		 $s39= "81A412E6-8103-4B06-857F-1862781024AC" fullword wide
		 $s40= "88a7cb15-7b07-4a34-9128-e64c6703c4d3" fullword wide
		 $s41= "8d030fb8-cc43-4258-a22e-9210bef89be4" fullword wide
		 $s42= "8eae8cf3-a44f-4306-ba5c-bf5dda242818" fullword wide
		 $s43= "8ec2e9fd-9148-410d-831e-702439461a8e" fullword wide
		 $s44= "a634a91c-822b-41b9-a494-4de4643612b0" fullword wide
		 $s45= "a7fb87af-2d02-42fb-a4d4-05cd93843bdd" fullword wide
		 $s46= "a901aaba-e037-458a-bdf6-545be2074042" fullword wide
		 $s47= "api-ms-win-rtcore-ntuser-window-l1-1-0" fullword wide
		 $s48= "api-ms-win-security-systemfunctions-l1-1-0" fullword wide
		 $s49= "AspNetSynchronizationContext" fullword wide
		 $s50= "b6bc765f-4c3b-40a4-bd51-2535b66fe09d" fullword wide
		 $s51= "b8ebefaf-b718-4e04-b0a9-116775e3321b" fullword wide
		 $s52= "bfbabe79-7434-4d1c-94f0-72a3b9e17188" fullword wide
		 $s53= "Browsers/Download-History [" fullword wide
		 $s54= "Browsers/Unknowns/Cookies [" fullword wide
		 $s55= "Browsers/Unknowns/Download-History [" fullword wide
		 $s56= "Browsers/Unknowns/Forms [" fullword wide
		 $s57= "Browsers/Unknowns/Passwords [" fullword wide
		 $s58= "Browsers/Unknowns/URL-History [" fullword wide
		 $s59= "c9173739-5e56-461c-b713-46fb995cb95f" fullword wide
		 $s60= "Capi-ms-win-appmodel-runtime-l1-1-1" fullword wide
		 $s61= "ceabba49-506d-4757-a6ff-66c184987e4e" fullword wide
		 $s62= "CommandLineSelfExtractorStub.cs" fullword wide
		 $s63= "Content-Type: application/x-www-form-urlencoded" fullword wide
		 $s64= "CryptProtectMemory failed" fullword wide
		 $s65= "CryptUnprotectMemory failed" fullword wide
		 $s66= "discordLocal Storageleveldb" fullword wide
		 $s67= "e06d802c-db46-11cf-b4d1-00805f6cbbea" fullword wide
		 $s68= "e5666d6b-3422-4eb6-a421-da7db1f8e207" fullword wide
		 $s69= "e69669a0-3dcd-40cb-9e2e-3708387c0616" fullword wide
		 $s70= "ext-ms-win-kernel32-package-current-l1-1-0" fullword wide
		 $s71= "ext-ms-win-ntuser-dialogbox-l1-1-0" fullword wide
		 $s72= "ext-ms-win-ntuser-windowstation-l1-1-0" fullword wide
		 $s73= "f2deb57f-40fa-4764-aa33-ed4f2d1ff669" fullword wide
		 $s74= "f7e34c9a-42e8-4714-b74b-cb29d72c35e5" fullword wide
		 $s75= "f81a699a-649a-497d-8c73-29f8fed6ad7a" fullword wide
		 $s76= "FileZillarecentservers.xml" fullword wide
		 $s77= "FileZillasitemanager.xml" fullword wide
		 $s78= "(([^'fnrtvx85p{Z}])" fullword wide
		 $s79= ")([^'fnrtvx85p{Z}])" fullword wide
		 $s80= "GetDelegateForFunctionPointer" fullword wide
		 $s81= "https://steamcommunity.com/profiles/" fullword wide
		 $s82= "Invalid ZlibStreamFlavor." fullword wide
		 $s83= "Ionic.Zip.Forms.PasswordDialog.resources" fullword wide
		 $s84= "Ionic.Zip.Forms.ZipContentsDialog.resources" fullword wide
		 $s85= "Ionic.Zip.Resources.ZippedResources.zip" fullword wide
		 $s86= "Ionic.Zip.WinFormsSelfExtractorStub.resources" fullword wide
		 $s87= "JhcsNoKVYNCd10WiYn.nVOyk55waJejtxb2eF" fullword wide
		 $s88= "{{Left={0},Top={1},Right={2},Bottom={3}}}" fullword wide
		 $s89= "LegacyAspNetSynchronizationContext" fullword wide
		 $s90= "MediaFoundationReadError {0}" fullword wide
		 $s91= "multipart/form-data; boundary=" fullword wide
		 $s92= "Other/Discord Token(s).txt" fullword wide
		 $s93= "Other/FileZilla#recentservers.xml" fullword wide
		 $s94= "Other/FileZilla#sitemanager.xml" fullword wide
		 $s95= "Other/Steam#Information.txt" fullword wide
		 $s96= "Other/Telegram#Information.txt" fullword wide
		 $s97= "ParallelDeflateMaxBufferPairs" fullword wide
		 $s98= "PasswordDialog.Designer.cs" fullword wide
		 $s99= "pi-ms-win-core-datetime-l1-1-1" fullword wide
		 $s100= "pi-ms-win-core-fibers-l1-1-1" fullword wide
		 $s101= "pi-ms-win-core-file-l2-1-1" fullword wide
		 $s102= "pi-ms-win-core-localization-l1-2-1" fullword wide
		 $s103= "pi-ms-win-core-localization-obsolete-l1-2-0" fullword wide
		 $s104= "pi-ms-win-core-processthreads-l1-1-2" fullword wide
		 $s105= "pi-ms-win-core-string-l1-1-0" fullword wide
		 $s106= "pi-ms-win-core-synch-l1-2-0" fullword wide
		 $s107= "pi-ms-win-core-sysinfo-l1-2-1" fullword wide
		 $s108= "pi-ms-win-core-winrt-l1-1-0" fullword wide
		 $s109= "pi-ms-win-core-xstate-l2-1-0" fullword wide
		 $s110= "SeCreateSymbolicLinkPrivilege" fullword wide
		 $s111= "SoftwareMicrosoftWindowsCurrentVersion" fullword wide
		 $s112= "SoftwareMicrosoftWindowsCurrentVersionRun" fullword wide
		 $s113= "SoftwareMicrosoftWindows NTCurrentVersionWinlogon" fullword wide
		 $s114= "System.Security.Cryptography.AesCryptoServiceProvider" fullword wide
		 $s115= "TJGoyVWXoJ2W5vCNWB.KuZd2xLjvpUN6sHPaL" fullword wide
		 $s116= "__tmp_rar_sfx_access_check_%u" fullword wide
		 $s117= "WinFormsSelfExtractorStub.cs" fullword wide
		 $s118= "WinFormsSelfExtractorStub.Designer.cs" fullword wide
		 $s119= "ZipContentsDialog.Designer.cs" fullword wide
		 $s120= "ZipInputStream::{0}(leaveOpen({1})))" fullword wide
		 $s121= "ZipOutputStream::{0}(leaveOpen({1})))" fullword wide
		 $a1= "*(,(-(43EDGFPOTSVUXWa`cbedfdgdhdjinmompmqmwvxvzy|{~}" fullword ascii
		 $a2= "SoftwareMicrosoftWindows NTCurrentVersionWinlogon" fullword ascii
		 $a3= "System.Security.Cryptography.AesCryptoServiceProvider" fullword ascii

		 $hex1= {2461313d20222a282c}
		 $hex2= {2461323d2022536f66}
		 $hex3= {2461333d2022537973}
		 $hex4= {24733130303d202270}
		 $hex5= {24733130313d202270}
		 $hex6= {24733130323d202270}
		 $hex7= {24733130333d202270}
		 $hex8= {24733130343d202270}
		 $hex9= {24733130353d202270}
		 $hex10= {24733130363d202270}
		 $hex11= {24733130373d202270}
		 $hex12= {24733130383d202270}
		 $hex13= {24733130393d202270}
		 $hex14= {247331303d20223266}
		 $hex15= {24733131303d202253}
		 $hex16= {24733131313d202253}
		 $hex17= {24733131323d202253}
		 $hex18= {24733131333d202253}
		 $hex19= {24733131343d202253}
		 $hex20= {24733131353d202254}
		 $hex21= {24733131363d20225f}
		 $hex22= {24733131373d202257}
		 $hex23= {24733131383d202257}
		 $hex24= {24733131393d20225a}
		 $hex25= {247331313d20223331}
		 $hex26= {24733132303d20225a}
		 $hex27= {24733132313d20225a}
		 $hex28= {247331323d20223332}
		 $hex29= {247331333d20223333}
		 $hex30= {247331343d20223334}
		 $hex31= {247331353d20223337}
		 $hex32= {247331363d20223361}
		 $hex33= {247331373d20223432}
		 $hex34= {247331383d20222a28}
		 $hex35= {247331393d20222534}
		 $hex36= {2473313d20223d283f}
		 $hex37= {247332303d20223533}
		 $hex38= {247332313d20223534}
		 $hex39= {247332323d20223566}
		 $hex40= {247332333d20223638}
		 $hex41= {247332343d20223663}
		 $hex42= {247332353d20223663}
		 $hex43= {247332363d20223663}
		 $hex44= {247332373d20223663}
		 $hex45= {247332383d20223663}
		 $hex46= {247332393d20223663}
		 $hex47= {2473323d20223d283f}
		 $hex48= {247333303d20223663}
		 $hex49= {247333313d20223663}
		 $hex50= {247333323d20223663}
		 $hex51= {247333333d20223663}
		 $hex52= {247333343d20223663}
		 $hex53= {247333353d20223731}
		 $hex54= {247333363d20223733}
		 $hex55= {247333373d20223736}
		 $hex56= {247333383d20223765}
		 $hex57= {247333393d20223831}
		 $hex58= {2473333d2022283f3d}
		 $hex59= {247334303d20223838}
		 $hex60= {247334313d20223864}
		 $hex61= {247334323d20223865}
		 $hex62= {247334333d20223865}
		 $hex63= {247334343d20226136}
		 $hex64= {247334353d20226137}
		 $hex65= {247334363d20226139}
		 $hex66= {247334373d20226170}
		 $hex67= {247334383d20226170}
		 $hex68= {247334393d20224173}
		 $hex69= {2473343d2022283f3d}
		 $hex70= {247335303d20226236}
		 $hex71= {247335313d20226238}
		 $hex72= {247335323d20226266}
		 $hex73= {247335333d20224272}
		 $hex74= {247335343d20224272}
		 $hex75= {247335353d20224272}
		 $hex76= {247335363d20224272}
		 $hex77= {247335373d20224272}
		 $hex78= {247335383d20224272}
		 $hex79= {247335393d20226339}
		 $hex80= {2473353d20225e282e}
		 $hex81= {247336303d20224361}
		 $hex82= {247336313d20226365}
		 $hex83= {247336323d2022436f}
		 $hex84= {247336333d2022436f}
		 $hex85= {247336343d20224372}
		 $hex86= {247336353d20224372}
		 $hex87= {247336363d20226469}
		 $hex88= {247336373d20226530}
		 $hex89= {247336383d20226535}
		 $hex90= {247336393d20226536}
		 $hex91= {2473363d20227b307d}
		 $hex92= {247337303d20226578}
		 $hex93= {247337313d20226578}
		 $hex94= {247337323d20226578}
		 $hex95= {247337333d20226632}
		 $hex96= {247337343d20226637}
		 $hex97= {247337353d20226638}
		 $hex98= {247337363d20224669}
		 $hex99= {247337373d20224669}
		 $hex100= {247337383d20222828}
		 $hex101= {247337393d20222928}
		 $hex102= {2473373d2022313131}
		 $hex103= {247338303d20224765}
		 $hex104= {247338313d20226874}
		 $hex105= {247338323d2022496e}
		 $hex106= {247338333d2022496f}
		 $hex107= {247338343d2022496f}
		 $hex108= {247338353d2022496f}
		 $hex109= {247338363d2022496f}
		 $hex110= {247338373d20224a68}
		 $hex111= {247338383d20227b7b}
		 $hex112= {247338393d20224c65}
		 $hex113= {2473383d2022316161}
		 $hex114= {247339303d20224d65}
		 $hex115= {247339313d20226d75}
		 $hex116= {247339323d20224f74}
		 $hex117= {247339333d20224f74}
		 $hex118= {247339343d20224f74}
		 $hex119= {247339353d20224f74}
		 $hex120= {247339363d20224f74}
		 $hex121= {247339373d20225061}
		 $hex122= {247339383d20225061}
		 $hex123= {247339393d20227069}
		 $hex124= {2473393d2022323033}

	condition:
		82 of them
}
