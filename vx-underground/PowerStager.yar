
/*
   YARA Rule Set
   Author: resteex
   Identifier: PowerStager 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_PowerStager {
	meta: 
		 description= "PowerStager Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-15_00-16-45" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "00f4bb9d0c3e7023c5be36f1411e5ae6"
		 hash2= "033ef43e2fc05be4df22b18a6cf13a84"
		 hash3= "03466970458358cf83f7f9d54a116e38"
		 hash4= "04500eb32a8655bb624e9a2d7f4aa6d9"
		 hash5= "046315a928688d319a67baf335918fb9"
		 hash6= "048b17f92de0f57b70b0bd2bf06777e3"
		 hash7= "065984cf08e10d923134f11990b9e252"
		 hash8= "07dc12cca1b25ceb771132ce6c76fafb"
		 hash9= "0840e3b1fb772825822ef71c060d17cd"
		 hash10= "08d688191f87e754d9df08e512c83a3b"
		 hash11= "0b90b2a77c16a8e6ff7d716494be6f44"
		 hash12= "0b9343556b2730790158c5fb95df47ac"
		 hash13= "0bd14d48d4e97376b82d91184a3778f8"
		 hash14= "0dcf9e0b73ef8423c34c9b047027b71f"
		 hash15= "0eb8323212bc32c751407959121e46db"
		 hash16= "0f1b556b570f84b71048bd387c76bbe9"
		 hash17= "126579b970d658828150104fd9ac275e"
		 hash18= "1690964bc7320fbd670640885ae02253"
		 hash19= "177f2c6efb5067e868e6f2ee1eae7301"
		 hash20= "1ac46182ed96af56151fdd084cd327bf"
		 hash21= "1bb3689e5eb86866100104b033b717fe"
		 hash22= "1bbb0ab54f5a3de542c405e9f83424b9"
		 hash23= "1be73c9781ed32234294255e8649114d"
		 hash24= "1d604ad9784e2e6cce7cfeb285422298"
		 hash25= "1d95fbb604e9c7e3fdb9b15ff3e98e65"
		 hash26= "1df998e99c0176ef94d7f1a53fe72845"
		 hash27= "1eadabc5b58e913bf39d2fe0304c6a77"
		 hash28= "1f88cc10ef3f98fd768927c694bcfda3"
		 hash29= "20775c9013911ff10753ee2df9d3a3ed"
		 hash30= "22f3ca1eaf22efe008955817b39b626c"
		 hash31= "26c483abea2e31e36ea814c0a3696ab5"
		 hash32= "26ebab7223ab341820768fb3d92e8958"
		 hash33= "278bf6ed96b4c2a656397dca322419ca"
		 hash34= "27da48a43b3762ee339082d242a56da7"
		 hash35= "2ad80b42cee28287bd027e7f6fb4c71c"
		 hash36= "2b4e266a8da5412ab83b2990ce63f3bd"
		 hash37= "2ca849a0731a0f7a964798b643f419a1"
		 hash38= "2ccc0b6e3f90de6200a487d3131d2fdb"
		 hash39= "32784a46c41016b30892bc5b81d916ef"
		 hash40= "34c46e46b1e3e9661b419829a0c4358d"
		 hash41= "36e314d3776560fe04cf6698ff5640c2"
		 hash42= "37568ecc1c4273c7736aea893c03c605"
		 hash43= "390392bc470b2ab09ce8db6a17bd03f5"
		 hash44= "3a30f815e2082bba33e58be11369c51e"
		 hash45= "3ac6d487c6db359fc13d5c923eec7ab1"
		 hash46= "3b00a0043afe908ed2cb39ee8dedf177"
		 hash47= "3fc4fbbfbbf5d4322ce113a145f9e50a"
		 hash48= "407b9b60cd2a445fb96deaebdafb0551"
		 hash49= "4080544d3282bc6724c926a567620f6a"
		 hash50= "41635daca1fe4d81bd63a552dd2186c0"
		 hash51= "421015ef33d847f6119b271348886a8e"
		 hash52= "42b343ec4748071247f3f97bbc5b5dbb"
		 hash53= "4356fa4dfaeea81e659242e0bbdc6af0"
		 hash54= "43a09585dc4ab8dd8afa47f6414f0eb8"
		 hash55= "4464604c8c13afc40a0a78acc7193269"
		 hash56= "4467490ed1706ad9a7a5e39b669c9b7c"
		 hash57= "451d3aefddc3ebdf265270f2adc2fa6e"
		 hash58= "45c40a374aa4eff2fa2e021fff90c348"
		 hash59= "48265cc57481b53c4eabb7a1a6930c02"
		 hash60= "4893b49c477a604055db9364376bb75d"
		 hash61= "48bd5f845f2338b906d26b1e3234fe3e"
		 hash62= "497c5565876f53a847b7ea1939e18518"
		 hash63= "4a08bf559799e6c0cebd70ff959f99ab"
		 hash64= "4acadc64ce0bb8c58b3debb1dbad90f8"
		 hash65= "4af436d1a46f4e580b1133fc0180d0da"
		 hash66= "4d81e35d850cea42eed79b6e519d13bc"
		 hash67= "4dd43ec01d55b48c1a7e41770ecc96fc"
		 hash68= "4ea23b3715a1788f8bbc49ccec0e7ac8"
		 hash69= "4edf9002575159b99db5265861ddf8e9"
		 hash70= "4f00c110d7b7af3f45c44f1fc5b6e697"
		 hash71= "4f26f3fe5649331f7c0520a6f5f51372"
		 hash72= "515bb2cd113139445d27471ecb5f6f31"
		 hash73= "52193eff58613076a17b705f15dcde26"
		 hash74= "5388c49a32ad05ca3cb256a715732fdc"
		 hash75= "54f89eeab028edf1a0aa7516a5eed4e1"
		 hash76= "5597d924e8447accb063c91f99e7da56"
		 hash77= "5782974eac0b0028a53029734ae6dfe5"
		 hash78= "5887c5974d6a5b4f7b928a0465d4c89f"
		 hash79= "5914174b5e6c9e39e17f13a9cb7c3882"
		 hash80= "5a64c9f4b97d76e01376f5fc8bbdd2c9"
		 hash81= "5af7bbdd332c43070866c0fd3c5a0202"
		 hash82= "5cb6a9deddf8635bf25e843acd96f373"
		 hash83= "5cdcd27e8fdc1d1baa1d2080b14221c3"
		 hash84= "5d1c2dfcec28ab5322852a7a9bfaddfd"
		 hash85= "5d5587229f86f5e58276ba6c2f1e069c"
		 hash86= "5de70d76a309eab187efc4ca648754fe"
		 hash87= "5f9a49a22cc31fa00b3db0a94c26633d"
		 hash88= "610f985ec8d4988eaddbdc22fabde293"
		 hash89= "610f9c95ec48e37d1860392f2241b102"
		 hash90= "61fa184d9d50e53495c6006abbabefab"
		 hash91= "62cfd653442ca8cd25a102b1bc3e12c0"
		 hash92= "630abec76f6898893aa31bb901155ed8"
		 hash93= "63dbe1db2e3b716df06d14c200094aef"
		 hash94= "65976548992099876f968af187645170"
		 hash95= "6718079210b64b7320c554b21f912ff0"
		 hash96= "699a15fede363b759805bcb736ffce0f"
		 hash97= "6aea8cd797d01bc3d9108c4b06110608"
		 hash98= "6d0f9db8b834bad76c725c5ee02351a5"
		 hash99= "6d5548cea6d15be0db6e0f3621389eb1"
		 hash100= "6d8bb9bd2472f733104d134b19094c08"
		 hash101= "6de4a8147f2bd078b8b64750917d5196"
		 hash102= "6e77e66f7b30f5a9dc33452971e7eea3"
		 hash103= "6f01a3975b33a6cc92c31029a277c20f"
		 hash104= "6f21dfd2e4a86f8086658cf44b891342"
		 hash105= "6f4430e5ca08473047a560e75c3e2b3a"
		 hash106= "6f9ccc165bf748d661fc982051ac5a9c"
		 hash107= "6fdfafa02ba0eded2b8643df1cf742de"
		 hash108= "703664da9da040b3af98bb3850fe5efa"
		 hash109= "70e673add170404264550f619e29ee51"
		 hash110= "7475444c5b43a95231abaa32b8931202"
		 hash111= "74e8ac4f2bec72b51476fb7bc6bf8f55"
		 hash112= "74f07da3b5a6a85d72fb798c9e9e2ad8"
		 hash113= "753cf8ecf3e72787eceeae865aac220d"
		 hash114= "76862873810c6a6ad274ba4cc6957303"
		 hash115= "79b195192455c60e3a851dbe243894aa"
		 hash116= "79ea391126d6bbb0f4eb8152ba7ff87d"
		 hash117= "7a7dd1b06f5eb5ad6996fdfa21b0a0e2"
		 hash118= "7bcefb55df042df7f57b2d6db1971f90"
		 hash119= "7e3cb8c0079936c4a73062efb08fdfff"
		 hash120= "7ff4ade92e4b8f7cba66627dc97cde12"
		 hash121= "801a720e3c1cf29f411b4f7339708ff2"
		 hash122= "815d4db993508523f513b129d7b07f69"
		 hash123= "8435dd83958642db48b3659a10b535cc"
		 hash124= "8505868299c951d0b800a1e64bca09b1"
		 hash125= "858790d1e4e4df6dd44250b8d0c60621"
		 hash126= "85a07a71119850fd3ccd2449e6b4deaa"
		 hash127= "85c2653ece06308e6771787f5b1e7a12"
		 hash128= "861a0eee9ed6a2355902a7dd2118d44f"
		 hash129= "8720726a16009bada1f6c1d1f68cf69b"
		 hash130= "88d119b2b3006e4634e3b07a6caffb04"
		 hash131= "8901d9a711a63dd4c203f87f49526cb5"
		 hash132= "893b7e3e2e6ce06af12b4306a24c443d"
		 hash133= "8994b4137202fd6e57a32a2e8ce8ada9"
		 hash134= "89fd7bbb9044bd2576b9ecc95f55b5ec"
		 hash135= "8a77f0218c2a5497e18945aa36d24a8f"
		 hash136= "8cf605b6f8b8dc095bb846f627c733f6"
		 hash137= "8d109ccdfb4c7d78dca8d21fae75bf3d"
		 hash138= "8d1277fd657e3d94196173b6a96c896c"
		 hash139= "8de35f4c4f85058e0b184371c48ee80a"
		 hash140= "8e219cb59f6696bc51b3181b3554dd91"
		 hash141= "8e8a1363f47dd71400ed55108a479570"
		 hash142= "8f9e1af0ce0f4a1430903ae63539f5c0"
		 hash143= "8fd35164fcf05f2b0885e1ae04e05985"
		 hash144= "914e6cb5ff986d253ed40faffddffc6a"
		 hash145= "921a13dddfb825a42a96acd363ff7b34"
		 hash146= "92f15a4a85f429d85abd114d9cdfda74"
		 hash147= "934327d1f19278d2f214a146a6ddc1f2"
		 hash148= "9375700b8fd34cc3522b0d4155e11987"
		 hash149= "938db55f4c087a1a57a00ed0a00cf4f8"
		 hash150= "94a2a1e0841ceff95e7b7352627ad11a"
		 hash151= "955b0831cc232e06e6b77ff7aa42bbc6"
		 hash152= "97376cd213e8efcdead3d7636a9c6562"
		 hash153= "9772f4e7442096efe756df2c0a4d2dc1"
		 hash154= "98b695f408bfc7d9aad0c08175579d30"
		 hash155= "9a12f532ef747c32e307aaad50c281b9"
		 hash156= "9ba3fdaedbf2a196aaa3286ce4c2a085"
		 hash157= "9c2d54bd988d0dac58c61fb1cbc87d40"
		 hash158= "9c5ff41a12361437548777df877d1c09"
		 hash159= "9fedba41febc10ed5ebeff0c69a5008f"
		 hash160= "a1215855899dd39ee18971a87842d03c"
		 hash161= "a30eab18488d6ef491f841f917294fd5"
		 hash162= "a31c340eb8aef0c8eaec00e3e9c12748"
		 hash163= "a48f2033f86b394aaea17f1d733b389f"
		 hash164= "a49826f4fc4029f4ae364e4c33764060"
		 hash165= "a970352ec26df3289690ddcde3b8a01b"
		 hash166= "a9d7eb903f407af316d000c84b40c447"
		 hash167= "ae8ad838d6716e3c7f19f65b76b7245e"
		 hash168= "aed5733d7bf6b4c386f97fc3c2228b29"
		 hash169= "af435b7c1e022d70e9c4468f521dbd08"
		 hash170= "b08630852febf6b9746daf668273dbee"
		 hash171= "b1bf80481230327d2b9e51b69f7d8f4f"
		 hash172= "b25ebbc345a60473266a6c80a78108b9"
		 hash173= "b2df5c25b412317f3bbb328508f59a7e"
		 hash174= "b40f65ff0803713373b9134ebf1c5a17"
		 hash175= "b491596d176afe4eda0d770062b3bc87"
		 hash176= "b4eca0643e8deccc014f49ce5981bb54"
		 hash177= "b5d858a934b007f8818cf80e90d21630"
		 hash178= "b65ae43fd8bd37bc5622656a350c0b09"
		 hash179= "b6e11bde3a172e340f72beedbe646c76"
		 hash180= "b806b45e46937a84b43bd6ee63038dd7"
		 hash181= "ba1682163a26f40bfa47e433a30707ed"
		 hash182= "bad0e44541d787f0428c5c7572ff4b0e"
		 hash183= "bafa7f51aa9413668def6f2ac79a19d7"
		 hash184= "bb5cc07b7eee18204f836e1d2bc2d7b4"
		 hash185= "bbea6ec84876d37fd3ff59c3287e04f5"
		 hash186= "bdc5ede04b6566e76aed93156e303c76"
		 hash187= "bf769680ff6e155ab4e72cfca6eb8ada"
		 hash188= "c1874fafdf57030bdae888ff9e6684fb"
		 hash189= "c18af72fe4fdd2203a941be03379bb58"
		 hash190= "c2791e16b1bdd4cb497ffaf5faa1a691"
		 hash191= "c46483e8172c07b23c06e4f34cf243ef"
		 hash192= "c55a924fb3301f4cebe145ca8af481bd"
		 hash193= "c6568d92fb68a5f2e18a481bb6d40c7f"
		 hash194= "c6d3b8211db8329ae97ba3b8b8ed9f4c"
		 hash195= "c988b0c1da6c106e9d7c0d25311da803"
		 hash196= "ca96541c8db8e317137a5e1e1a982320"
		 hash197= "cb7684a7ef17e0ca3e6f241a5386dcf8"
		 hash198= "cc4796cb92309ea53e536385f50ca2cd"
		 hash199= "cc5512c4f5f0d3e9de1c01414fe4af3c"
		 hash200= "ccd6301647964a24d8c585323d5adae9"
		 hash201= "ccfdd69feb5544e5dff3d3693cd5f0f2"
		 hash202= "cd326042a9d97a64293a641b2ca13b96"
		 hash203= "cfb7ad7fac19df1aacc1289fab8813df"
		 hash204= "cfc8bc5ff1d385367e4b8586518e75f9"
		 hash205= "d1f6bfdf51fbe8ba571525724db86467"
		 hash206= "d24fcd10c02ecc8e18df5a78e80e5df3"
		 hash207= "d27f5b554676fb7c0e6ac87818eb615e"
		 hash208= "d341eeb6059c2114e83ed10377210116"
		 hash209= "d4f950500ef4ad83979ea476c7418f04"
		 hash210= "d598d8bc9892aa0ed3df39708c93330c"
		 hash211= "d69c6df17e80efcd8ca296e3da029830"
		 hash212= "d6fe61cc4ddc81b6f2e895c15fe96f42"
		 hash213= "db5f2605184a6f604accbd474f5323db"
		 hash214= "dbe4f4422af1a793414bddbd54e13e9a"
		 hash215= "dbf92198e15ecd73ff8cc275c5131992"
		 hash216= "dc0382d8a213ac2b92999c3829beeb26"
		 hash217= "dcb3727c00bc9fcd9463e50bc85838b0"
		 hash218= "dd5b6314f4f9b847d11e5a7fa8579247"
		 hash219= "dd84e92bacf03d2407ee7452fd9da74b"
		 hash220= "ddab2cb339e03e08e6c50b23dea3d280"
		 hash221= "def84fbcd2283e64c71f21d05007e470"
		 hash222= "def9b96ca74c4dcee9a1b560e4c79fb8"
		 hash223= "e074fe033350c3000c6fe3e0b962717f"
		 hash224= "e2950970cc6b43f788cddbe8fc5bd793"
		 hash225= "e3af34c0b4371a2ef8edfad6fef7ccb3"
		 hash226= "e46ab6b1524f2e14cb24c9bd44749740"
		 hash227= "e514a87a3540d371298ff55df4d046cd"
		 hash228= "e54620808510d190ec1f86abff52b6cb"
		 hash229= "e56ee9de2625c3c029e66fefeda2f686"
		 hash230= "e6f7c07746b7c8788780c6b4ee6634d0"
		 hash231= "e89aa64f9e05b7836d32d3151ad0dae0"
		 hash232= "ec1426181064720617d73a51d10898a1"
		 hash233= "ed7eefadd3b69d1db6c38ee2350cf89a"
		 hash234= "ee92ebc23a65be98eb52d1cc2fcd9a99"
		 hash235= "f25860bd0d87b5941d6f5f8d6376d781"
		 hash236= "f2b6381c00f782e707c97f52d2858008"
		 hash237= "f302db09150943e0e11ac97e44ba9be4"
		 hash238= "f3d296c4582dd3173a8d861a4ace3e00"
		 hash239= "f4b54c7d085f464a5ffe3c5d630adf51"
		 hash240= "f563f099ca8f841ae5412754a7b1eb2c"
		 hash241= "f6197f587f4152489d6112d5b514a697"
		 hash242= "f650cf24e494a86c85fb6fe47b052493"
		 hash243= "f6803262cc3f4d6ecbb0f18ffb000da4"
		 hash244= "f78b9f21b0f9efd7c815f962aea5343f"
		 hash245= "f7984f0776b589f7fd0efc8813d569fc"
		 hash246= "f7ccb307ea07a9d880ed2ff0a9c1c7fa"
		 hash247= "f955b90b6d90ba759a1d56c1eebf67af"
		 hash248= "f9aef3f75fabebde94d4258049977cff"
		 hash249= "faee0d20b318b7b823893db89cd56023"
		 hash250= "ff48a6014cc8e880ef77406ce40f7144"
		 hash251= "ff8743c0371a9cd696c4ea7c5d277a86"

	strings:

	
 		 $s1= "%4d-%02d-%02d-%02d-%02d-%02d-%03d" fullword wide
		 $s2= "api-ms-win-rtcore-ntuser-window-l1-1-0" fullword wide
		 $s3= "api-ms-win-security-systemfunctions-l1-1-0" fullword wide
		 $s4= "Capi-ms-win-appmodel-runtime-l1-1-1" fullword wide
		 $s5= "CryptProtectMemory failed" fullword wide
		 $s6= "CryptUnprotectMemory failed" fullword wide
		 $s7= "ext-ms-win-kernel32-package-current-l1-1-0" fullword wide
		 $s8= "ext-ms-win-ntuser-dialogbox-l1-1-0" fullword wide
		 $s9= "ext-ms-win-ntuser-windowstation-l1-1-0" fullword wide
		 $s10= "pi-ms-win-core-datetime-l1-1-1" fullword wide
		 $s11= "pi-ms-win-core-fibers-l1-1-1" fullword wide
		 $s12= "pi-ms-win-core-file-l2-1-1" fullword wide
		 $s13= "pi-ms-win-core-localization-l1-2-1" fullword wide
		 $s14= "pi-ms-win-core-localization-obsolete-l1-2-0" fullword wide
		 $s15= "pi-ms-win-core-processthreads-l1-1-2" fullword wide
		 $s16= "pi-ms-win-core-string-l1-1-0" fullword wide
		 $s17= "pi-ms-win-core-synch-l1-2-0" fullword wide
		 $s18= "pi-ms-win-core-sysinfo-l1-2-1" fullword wide
		 $s19= "pi-ms-win-core-winrt-l1-1-0" fullword wide
		 $s20= "pi-ms-win-core-xstate-l2-1-0" fullword wide
		 $s21= "SeCreateSymbolicLinkPrivilege" fullword wide
		 $s22= "SoftwareMicrosoftWindowsCurrentVersion" fullword wide
		 $s23= "__tmp_rar_sfx_access_check_%u" fullword wide

		 $hex1= {247331303d20227069}
		 $hex2= {247331313d20227069}
		 $hex3= {247331323d20227069}
		 $hex4= {247331333d20227069}
		 $hex5= {247331343d20227069}
		 $hex6= {247331353d20227069}
		 $hex7= {247331363d20227069}
		 $hex8= {247331373d20227069}
		 $hex9= {247331383d20227069}
		 $hex10= {247331393d20227069}
		 $hex11= {2473313d2022253464}
		 $hex12= {247332303d20227069}
		 $hex13= {247332313d20225365}
		 $hex14= {247332323d2022536f}
		 $hex15= {247332333d20225f5f}
		 $hex16= {2473323d2022617069}
		 $hex17= {2473333d2022617069}
		 $hex18= {2473343d2022436170}
		 $hex19= {2473353d2022437279}
		 $hex20= {2473363d2022437279}
		 $hex21= {2473373d2022657874}
		 $hex22= {2473383d2022657874}
		 $hex23= {2473393d2022657874}

	condition:
		15 of them
}
