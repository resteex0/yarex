
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_Winnti_5f851ffcee7f301bfcffc3c023a78611f6a1264575ffbafa1f3bc420b27f7eac 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_Winnti_5f851ffcee7f301bfcffc3c023a78611f6a1264575ffbafa1f3bc420b27f7eac {
	meta: 
		 description= "APTMalware_Winnti_5f851ffcee7f301bfcffc3c023a78611f6a1264575ffbafa1f3bc420b27f7eac Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-57-56" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "de7d2d4a6b093365013e6acf3e1d5a41"

	strings:

	
 		 $s1= "DeviceGpeNetSafe" fullword wide
		 $s2= "DosDevicesGpeNetSafe" fullword wide
		 $s3= "InprocServer32" fullword wide
		 $s4= "ObGetObjectType" fullword wide
		 $s5= "ObQueryNameInfo" fullword wide
		 $s6= "PendingFileRenameOperations" fullword wide
		 $s7= "PsReferenceProcessFilePointer" fullword wide
		 $s8= "VS_VERSION_INFO" fullword wide

		 $hex1= {44??65??76??69??63??65??47??70??65??4e??65??74??53??61??66??65??0a??}
		 $hex2= {44??6f??73??44??65??76??69??63??65??73??47??70??65??4e??65??74??53??61??66??65??0a??}
		 $hex3= {49??6e??70??72??6f??63??53??65??72??76??65??72??33??32??0a??}
		 $hex4= {4f??62??47??65??74??4f??62??6a??65??63??74??54??79??70??65??0a??}
		 $hex5= {4f??62??51??75??65??72??79??4e??61??6d??65??49??6e??66??6f??0a??}
		 $hex6= {50??65??6e??64??69??6e??67??46??69??6c??65??52??65??6e??61??6d??65??4f??70??65??72??61??74??69??6f??6e??73??0a??}
		 $hex7= {50??73??52??65??66??65??72??65??6e??63??65??50??72??6f??63??65??73??73??46??69??6c??65??50??6f??69??6e??74??65??72??0a??}
		 $hex8= {56??53??5f??56??45??52??53??49??4f??4e??5f??49??4e??46??4f??0a??}

	condition:
		8 of them
}
