
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_28_44e8d3ffa0989176e62b8462b3d14ad38ede5f859fd3d5eb387050f751080aa2 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_28_44e8d3ffa0989176e62b8462b3d14ad38ede5f859fd3d5eb387050f751080aa2 {
	meta: 
		 description= "APTMalware_APT_28_44e8d3ffa0989176e62b8462b3d14ad38ede5f859fd3d5eb387050f751080aa2 Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-11-13" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "991ffdbf860756a4589164de26dd7ccf"

	strings:

	
 		 $s1= "AppPatchCustom*.sdb" fullword wide
		 $s2= "ConsentPromptBehaviorAdmin" fullword wide
		 $s3= "FsFltParametersc1" fullword wide
		 $s4= "FsFltParametersc3" fullword wide
		 $s5= "PLATFORMTARGETS" fullword wide
		 $s6= "PromptOnSecureDesktop" fullword wide
		 $s7= "SeLoadDriverPrivilege" fullword wide
		 $s8= "%sSystem32sdbinst.exe" fullword wide
		 $s9= "%sSystem32wusa.exe" fullword wide
		 $s10= "VS_VERSION_INFO" fullword wide

		 $hex1= {25??73??53??79??73??74??65??6d??33??32??73??64??62??69??6e??73??74??2e??65??78??65??0a??}
		 $hex2= {25??73??53??79??73??74??65??6d??33??32??77??75??73??61??2e??65??78??65??0a??}
		 $hex3= {41??70??70??50??61??74??63??68??43??75??73??74??6f??6d??2a??2e??73??64??62??0a??}
		 $hex4= {43??6f??6e??73??65??6e??74??50??72??6f??6d??70??74??42??65??68??61??76??69??6f??72??41??64??6d??69??6e??0a??}
		 $hex5= {46??73??46??6c??74??50??61??72??61??6d??65??74??65??72??73??63??31??0a??}
		 $hex6= {46??73??46??6c??74??50??61??72??61??6d??65??74??65??72??73??63??33??0a??}
		 $hex7= {50??4c??41??54??46??4f??52??4d??54??41??52??47??45??54??53??0a??}
		 $hex8= {50??72??6f??6d??70??74??4f??6e??53??65??63??75??72??65??44??65??73??6b??74??6f??70??0a??}
		 $hex9= {53??65??4c??6f??61??64??44??72??69??76??65??72??50??72??69??76??69??6c??65??67??65??0a??}
		 $hex10= {56??53??5f??56??45??52??53??49??4f??4e??5f??49??4e??46??4f??0a??}

	condition:
		11 of them
}
