
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_28_4dd8ab2471337a56b431433b7e8db2a659dc5d9dc5481b4209c4cddd07d6dc2b 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_28_4dd8ab2471337a56b431433b7e8db2a659dc5d9dc5481b4209c4cddd07d6dc2b {
	meta: 
		 description= "APTMalware_APT_28_4dd8ab2471337a56b431433b7e8db2a659dc5d9dc5481b4209c4cddd07d6dc2b Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-12-06" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "1d1287d4a3ba5d02cca91f51863db738"

	strings:

	
 		 $s1= "2_wsopen_nolock" fullword wide
		 $s2= "%)+/5;=CGIOSYaegkmq" fullword wide
		 $s3= "Accept-Encoding: gzip,deflate,sdch" fullword wide
		 $s4= "Assertion Failed" fullword wide
		 $s5= "Assertion failed!" fullword wide
		 $s6= "Cache-Control: max-age=0" fullword wide
		 $s7= "Connection: keep-alive" fullword wide
		 $s8= "__copy_path_to_wide_string" fullword wide
		 $s9= "_CrtCheckMemory()" fullword wide
		 $s10= "_CrtIsValidHeapPointer(pUserData)" fullword wide
		 $s11= "_CrtMemCheckpoint" fullword wide
		 $s12= ".__crtMessageWindowA" fullword wide
		 $s13= "__crtMessageWindowW" fullword wide
		 $s14= "_fread_nolock_s" fullword wide
		 $s15= "_get_daylight(&daylight)" fullword wide
		 $s16= "_get_dstbias(&dstbias)" fullword wide
		 $s17= "_get_fmode(&fmode)" fullword wide
		 $s18= "_get_timezone(&timezone)" fullword wide
		 $s19= "_isindst_nolock" fullword wide
		 $s20= "isleadbyte(_dbcsBuffer(fh))" fullword wide

		 $hex1= {25??29??2b??2f??35??3b??3d??43??47??49??4f??53??59??61??65??67??6b??6d??71??0a??}
		 $hex2= {2e??5f??5f??63??72??74??4d??65??73??73??61??67??65??57??69??6e??64??6f??77??41??0a??}
		 $hex3= {32??5f??77??73??6f??70??65??6e??5f??6e??6f??6c??6f??63??6b??0a??}
		 $hex4= {41??63??63??65??70??74??2d??45??6e??63??6f??64??69??6e??67??3a??20??67??7a??69??70??2c??64??65??66??6c??61??74??65??2c??}
		 $hex5= {41??73??73??65??72??74??69??6f??6e??20??46??61??69??6c??65??64??0a??}
		 $hex6= {41??73??73??65??72??74??69??6f??6e??20??66??61??69??6c??65??64??21??0a??}
		 $hex7= {43??61??63??68??65??2d??43??6f??6e??74??72??6f??6c??3a??20??6d??61??78??2d??61??67??65??3d??30??0a??}
		 $hex8= {43??6f??6e??6e??65??63??74??69??6f??6e??3a??20??6b??65??65??70??2d??61??6c??69??76??65??0a??}
		 $hex9= {5f??43??72??74??43??68??65??63??6b??4d??65??6d??6f??72??79??28??29??0a??}
		 $hex10= {5f??43??72??74??49??73??56??61??6c??69??64??48??65??61??70??50??6f??69??6e??74??65??72??28??70??55??73??65??72??44??61??}
		 $hex11= {5f??43??72??74??4d??65??6d??43??68??65??63??6b??70??6f??69??6e??74??0a??}
		 $hex12= {5f??5f??63??6f??70??79??5f??70??61??74??68??5f??74??6f??5f??77??69??64??65??5f??73??74??72??69??6e??67??0a??}
		 $hex13= {5f??5f??63??72??74??4d??65??73??73??61??67??65??57??69??6e??64??6f??77??57??0a??}
		 $hex14= {5f??66??72??65??61??64??5f??6e??6f??6c??6f??63??6b??5f??73??0a??}
		 $hex15= {5f??67??65??74??5f??64??61??79??6c??69??67??68??74??28??26??64??61??79??6c??69??67??68??74??29??0a??}
		 $hex16= {5f??67??65??74??5f??64??73??74??62??69??61??73??28??26??64??73??74??62??69??61??73??29??0a??}
		 $hex17= {5f??67??65??74??5f??66??6d??6f??64??65??28??26??66??6d??6f??64??65??29??0a??}
		 $hex18= {5f??67??65??74??5f??74??69??6d??65??7a??6f??6e??65??28??26??74??69??6d??65??7a??6f??6e??65??29??0a??}
		 $hex19= {5f??69??73??69??6e??64??73??74??5f??6e??6f??6c??6f??63??6b??0a??}
		 $hex20= {69??73??6c??65??61??64??62??79??74??65??28??5f??64??62??63??73??42??75??66??66??65??72??28??66??68??29??29??0a??}

	condition:
		22 of them
}
