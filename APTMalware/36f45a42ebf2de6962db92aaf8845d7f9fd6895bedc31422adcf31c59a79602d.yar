
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_1_36f45a42ebf2de6962db92aaf8845d7f9fd6895bedc31422adcf31c59a79602d 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_1_36f45a42ebf2de6962db92aaf8845d7f9fd6895bedc31422adcf31c59a79602d {
	meta: 
		 description= "APTMalware_APT_1_36f45a42ebf2de6962db92aaf8845d7f9fd6895bedc31422adcf31c59a79602d Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-41-30" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "6a4fbcfb44717eae2145c761c1c99b6a"

	strings:

	
 		 $s1= "CREATE_MAILSLOT" fullword wide
		 $s2= "CREATE_NAMED_PIPE" fullword wide
		 $s3= "Devicemimikatz" fullword wide
		 $s4= "DIRECTORY_CONTROL" fullword wide
		 $s5= "DosDevicesmimikatz" fullword wide
		 $s6= "FILE_SYSTEM_CONTROL" fullword wide
		 $s7= "INTERNAL_DEVICE_CONTROL" fullword wide
		 $s8= "kListNotifyImages" fullword wide
		 $s9= "kListNotifyProcesses" fullword wide
		 $s10= "kListNotifyRegistry" fullword wide
		 $s11= "kListNotifyThreads" fullword wide
		 $s12= "kMiniFiltersList" fullword wide
		 $s13= "listMinifilters" fullword wide
		 $s14= "listNotifImages" fullword wide
		 $s15= "listNotifProcesses" fullword wide
		 $s16= "listNotifRegistry" fullword wide
		 $s17= "listNotifThreads" fullword wide
		 $s18= "QUERY_INFORMATION" fullword wide
		 $s19= "QUERY_VOLUME_INFORMATION" fullword wide
		 $s20= "RtlQueryModuleInformation" fullword wide

		 $hex1= {43??52??45??41??54??45??5f??4d??41??49??4c??53??4c??4f??54??0a??}
		 $hex2= {43??52??45??41??54??45??5f??4e??41??4d??45??44??5f??50??49??50??45??0a??}
		 $hex3= {44??49??52??45??43??54??4f??52??59??5f??43??4f??4e??54??52??4f??4c??0a??}
		 $hex4= {44??65??76??69??63??65??6d??69??6d??69??6b??61??74??7a??0a??}
		 $hex5= {44??6f??73??44??65??76??69??63??65??73??6d??69??6d??69??6b??61??74??7a??0a??}
		 $hex6= {46??49??4c??45??5f??53??59??53??54??45??4d??5f??43??4f??4e??54??52??4f??4c??0a??}
		 $hex7= {49??4e??54??45??52??4e??41??4c??5f??44??45??56??49??43??45??5f??43??4f??4e??54??52??4f??4c??0a??}
		 $hex8= {51??55??45??52??59??5f??49??4e??46??4f??52??4d??41??54??49??4f??4e??0a??}
		 $hex9= {51??55??45??52??59??5f??56??4f??4c??55??4d??45??5f??49??4e??46??4f??52??4d??41??54??49??4f??4e??0a??}
		 $hex10= {52??74??6c??51??75??65??72??79??4d??6f??64??75??6c??65??49??6e??66??6f??72??6d??61??74??69??6f??6e??0a??}
		 $hex11= {6b??4c??69??73??74??4e??6f??74??69??66??79??49??6d??61??67??65??73??0a??}
		 $hex12= {6b??4c??69??73??74??4e??6f??74??69??66??79??50??72??6f??63??65??73??73??65??73??0a??}
		 $hex13= {6b??4c??69??73??74??4e??6f??74??69??66??79??52??65??67??69??73??74??72??79??0a??}
		 $hex14= {6b??4c??69??73??74??4e??6f??74??69??66??79??54??68??72??65??61??64??73??0a??}
		 $hex15= {6b??4d??69??6e??69??46??69??6c??74??65??72??73??4c??69??73??74??0a??}
		 $hex16= {6c??69??73??74??4d??69??6e??69??66??69??6c??74??65??72??73??0a??}
		 $hex17= {6c??69??73??74??4e??6f??74??69??66??49??6d??61??67??65??73??0a??}
		 $hex18= {6c??69??73??74??4e??6f??74??69??66??50??72??6f??63??65??73??73??65??73??0a??}
		 $hex19= {6c??69??73??74??4e??6f??74??69??66??52??65??67??69??73??74??72??79??0a??}
		 $hex20= {6c??69??73??74??4e??6f??74??69??66??54??68??72??65??61??64??73??0a??}

	condition:
		22 of them
}
