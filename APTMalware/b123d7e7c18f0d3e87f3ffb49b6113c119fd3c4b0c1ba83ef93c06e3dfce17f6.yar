
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_Winnti_b123d7e7c18f0d3e87f3ffb49b6113c119fd3c4b0c1ba83ef93c06e3dfce17f6 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_Winnti_b123d7e7c18f0d3e87f3ffb49b6113c119fd3c4b0c1ba83ef93c06e3dfce17f6 {
	meta: 
		 description= "APTMalware_Winnti_b123d7e7c18f0d3e87f3ffb49b6113c119fd3c4b0c1ba83ef93c06e3dfce17f6 Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-58-42" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "35bdc5a2acf35bdf9fb9169e1a47d3e7"

	strings:

	
 		 $s1= "Advanced Server" fullword wide
		 $s2= "Business Edition" fullword wide
		 $s3= "[clear],strRandomFile[%s]" fullword wide
		 $s4= "clear successfully." fullword wide
		 $s5= "Datacenter Edition" fullword wide
		 $s6= "Datacenter Server" fullword wide
		 $s7= "Disk Information:" fullword wide
		 $s8= "[doAction_CreateThread],FileMG1" fullword wide
		 $s9= "[doAction_CreateThread],RDServer" fullword wide
		 $s10= "[doAction_CreateThread],rPortMap" fullword wide
		 $s11= "D:ZeusServer.txt" fullword wide
		 $s12= "Enterprise Edition" fullword wide
		 $s13= "[ExeCommand],recv [%s]" fullword wide
		 $s14= "[FileMG1],Entry,Socket[%d]" fullword wide
		 $s15= "[InitFirst],g_szDllName[%s]" fullword wide
		 $s16= "[InitFirst],g_szDllPath[%s]" fullword wide
		 $s17= "[InitFirst],g_szExePath[%s]" fullword wide
		 $s18= "[InitFirst],g_szServiceName[%s]" fullword wide
		 $s19= "Organization: %s" fullword wide
		 $s20= "ProcessorNameString" fullword wide

		 $hex1= {41??64??76??61??6e??63??65??64??20??53??65??72??76??65??72??0a??}
		 $hex2= {42??75??73??69??6e??65??73??73??20??45??64??69??74??69??6f??6e??0a??}
		 $hex3= {44??3a??5a??65??75??73??53??65??72??76??65??72??2e??74??78??74??0a??}
		 $hex4= {44??61??74??61??63??65??6e??74??65??72??20??45??64??69??74??69??6f??6e??0a??}
		 $hex5= {44??61??74??61??63??65??6e??74??65??72??20??53??65??72??76??65??72??0a??}
		 $hex6= {44??69??73??6b??20??49??6e??66??6f??72??6d??61??74??69??6f??6e??3a??0a??}
		 $hex7= {45??6e??74??65??72??70??72??69??73??65??20??45??64??69??74??69??6f??6e??0a??}
		 $hex8= {4f??72??67??61??6e??69??7a??61??74??69??6f??6e??3a??20??25??73??0a??}
		 $hex9= {50??72??6f??63??65??73??73??6f??72??4e??61??6d??65??53??74??72??69??6e??67??0a??}
		 $hex10= {5b??45??78??65??43??6f??6d??6d??61??6e??64??5d??2c??72??65??63??76??20??5b??25??73??5d??0a??}
		 $hex11= {5b??46??69??6c??65??4d??47??31??5d??2c??45??6e??74??72??79??2c??53??6f??63??6b??65??74??5b??25??64??5d??0a??}
		 $hex12= {5b??49??6e??69??74??46??69??72??73??74??5d??2c??67??5f??73??7a??44??6c??6c??4e??61??6d??65??5b??25??73??5d??0a??}
		 $hex13= {5b??49??6e??69??74??46??69??72??73??74??5d??2c??67??5f??73??7a??44??6c??6c??50??61??74??68??5b??25??73??5d??0a??}
		 $hex14= {5b??49??6e??69??74??46??69??72??73??74??5d??2c??67??5f??73??7a??45??78??65??50??61??74??68??5b??25??73??5d??0a??}
		 $hex15= {5b??49??6e??69??74??46??69??72??73??74??5d??2c??67??5f??73??7a??53??65??72??76??69??63??65??4e??61??6d??65??5b??25??73??}
		 $hex16= {5b??63??6c??65??61??72??5d??2c??73??74??72??52??61??6e??64??6f??6d??46??69??6c??65??5b??25??73??5d??0a??}
		 $hex17= {5b??64??6f??41??63??74??69??6f??6e??5f??43??72??65??61??74??65??54??68??72??65??61??64??5d??2c??46??69??6c??65??4d??47??}
		 $hex18= {5b??64??6f??41??63??74??69??6f??6e??5f??43??72??65??61??74??65??54??68??72??65??61??64??5d??2c??52??44??53??65??72??76??}
		 $hex19= {5b??64??6f??41??63??74??69??6f??6e??5f??43??72??65??61??74??65??54??68??72??65??61??64??5d??2c??72??50??6f??72??74??4d??}
		 $hex20= {63??6c??65??61??72??20??73??75??63??63??65??73??73??66??75??6c??6c??79??2e??0a??}

	condition:
		22 of them
}
