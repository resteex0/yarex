
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_21_6aa24766ff48239eed0ec20a8c2e05704650e73de941470cc053e1000bea6470 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_21_6aa24766ff48239eed0ec20a8c2e05704650e73de941470cc053e1000bea6470 {
	meta: 
		 description= "APTMalware_APT_21_6aa24766ff48239eed0ec20a8c2e05704650e73de941470cc053e1000bea6470 Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-29-16" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "03e8d330abc77a6a9d635d2e7c0e213a"

	strings:

	
 		 $s1= ",44w#!9:7.83!Nd" fullword wide
		 $s2= "C:ProgramData" fullword wide
		 $s3= "FileDescription" fullword wide
		 $s4= "~h3{p{i*ffs~f}jn" fullword wide
		 $s5= ".[HXLhzL,hf||eerhh|)|`qq" fullword wide
		 $s6= "HYte8%UDQ@ u`9(`ud" fullword wide
		 $s7= "kbny%lU@pAXJ" fullword wide
		 $s8= "`md|s6U{l{zf7E8)" fullword wide
		 $s9= "|mxitepal}hydu`q%hydu`q|mxitepa" fullword wide
		 $s10= "okcua7r|wan+erbsAM^" fullword wide
		 $s11= "OriginalFilename" fullword wide
		 $s12= "sysprepCRYPTBASE.dll" fullword wide
		 $s13= "sysprepsysprep.exe" fullword wide
		 $s14= "VS_VERSION_INFO" fullword wide
		 $s15= "Win7ElevateDLL.dll" fullword wide
		 $s16= "Win7Elevate.exe" fullword wide
		 $s17= "Win7Elevate proof-of-concept" fullword wide
		 $s18= "yh}lq`udixm|apet1xm|apetyh}lq`ud" fullword wide
		 $s19= "/ZIYEi{M-}kww`)9=dx{5fteC" fullword wide

		 $hex1= {2c??34??34??77??23??21??39??3a??37??2e??38??33??21??4e??64??0a??}
		 $hex2= {2e??5b??48??58??4c??68??7a??4c??2c??68??66??7c??7c??65??65??72??68??68??7c??29??7c??60??71??71??0a??}
		 $hex3= {2f??5a??49??59??45??69??7b??4d??2d??7d??6b??77??77??60??29??39??3d??64??78??7b??35??66??74??65??43??0a??}
		 $hex4= {43??3a??50??72??6f??67??72??61??6d??44??61??74??61??0a??}
		 $hex5= {46??69??6c??65??44??65??73??63??72??69??70??74??69??6f??6e??0a??}
		 $hex6= {48??59??74??65??38??25??55??44??51??40??20??75??60??39??28??60??75??64??0a??}
		 $hex7= {4f??72??69??67??69??6e??61??6c??46??69??6c??65??6e??61??6d??65??0a??}
		 $hex8= {56??53??5f??56??45??52??53??49??4f??4e??5f??49??4e??46??4f??0a??}
		 $hex9= {57??69??6e??37??45??6c??65??76??61??74??65??20??70??72??6f??6f??66??2d??6f??66??2d??63??6f??6e??63??65??70??74??0a??}
		 $hex10= {57??69??6e??37??45??6c??65??76??61??74??65??2e??65??78??65??0a??}
		 $hex11= {57??69??6e??37??45??6c??65??76??61??74??65??44??4c??4c??2e??64??6c??6c??0a??}
		 $hex12= {60??6d??64??7c??73??36??55??7b??6c??7b??7a??66??37??45??38??29??0a??}
		 $hex13= {6b??62??6e??79??25??6c??55??40??70??41??58??4a??0a??}
		 $hex14= {6f??6b??63??75??61??37??72??7c??77??61??6e??2b??65??72??62??73??41??4d??5e??0a??}
		 $hex15= {73??79??73??70??72??65??70??43??52??59??50??54??42??41??53??45??2e??64??6c??6c??0a??}
		 $hex16= {73??79??73??70??72??65??70??73??79??73??70??72??65??70??2e??65??78??65??0a??}
		 $hex17= {79??68??7d??6c??71??60??75??64??69??78??6d??7c??61??70??65??74??31??78??6d??7c??61??70??65??74??79??68??7d??6c??71??60??}
		 $hex18= {7c??6d??78??69??74??65??70??61??6c??7d??68??79??64??75??60??71??25??68??79??64??75??60??71??7c??6d??78??69??74??65??70??}
		 $hex19= {7e??68??33??7b??70??7b??69??2a??66??66??73??7e??66??7d??6a??6e??0a??}

	condition:
		21 of them
}
