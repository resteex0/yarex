
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_10_5bb461b61837faa881d32849068c8e41172ccb6f86166582f46bdb450b98c1ef 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_10_5bb461b61837faa881d32849068c8e41172ccb6f86166582f46bdb450b98c1ef {
	meta: 
		 description= "APTMalware_APT_10_5bb461b61837faa881d32849068c8e41172ccb6f86166582f46bdb450b98c1ef Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-22_04-49-15" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "93a4328e1e347447044146b53972cd37"

	strings:

	
 		 $a1= "?AfxDynamicDownCast@@YAPAVCObject@@PAUCRuntimeClass@@PAV1@@Z" fullword ascii
		 $a2= "?Begin@CDrawDib@@QAEHPAUHDC__@@HHPAUtagBITMAPINFOHEADER@@HHI@Z" fullword ascii
		 $a3= "??_C@_0BN@KDJK@unsigned?5char?5shellcode?$FL?$FN?5?$DN?$HL?$AA@" fullword ascii
		 $a4= "??_C@_0CB@LBOB@R6018?$AN?6?9?5unexpected?5heap?5error?$AN?6@" fullword ascii
		 $a5= "?classCArchiveException@CArchiveException@@2UCRuntimeClass@@B" fullword ascii
		 $a6= "?classCResourceException@CResourceException@@2UCRuntimeClass@@B" fullword ascii
		 $a7= "?_connectionEntries@CCmdTarget@@0QBUAFX_CONNECTIONMAP_ENTRY@@B" fullword ascii
		 $a8= "?CreateInstance@AFX_COM@@QAEJABU_GUID@@PAUIUnknown@@0PAPAX@Z" fullword ascii
		 $a9= "?DrawDragRect@CDC@@QAEXPBUtagRECT@@UtagSIZE@@01PAVCBrush@@2@Z" fullword ascii
		 $a10= "?_eventsinkEntries@CCmdTarget@@0QBUAFX_EVENTSINKMAP_ENTRY@@B" fullword ascii
		 $a11= "?GetData@CProcessLocalObject@@QAEPAVCNoTrackObject@@P6GPAV2@XZ@Z" fullword ascii
		 $a12= "?GetData@CThreadLocalObject@@QAEPAVCNoTrackObject@@P6GPAV2@XZ@Z" fullword ascii
		 $a13= "?GetFont@CDialogTemplate@@SAHPBUDLGTEMPLATE@@AAVCString@@AAG@Z" fullword ascii
		 $a14= "?GetImage@CBomber@@UAE?AU_ImageIdentifierType@CImageManager@@XZ" fullword ascii
		 $a15= "?GetImage@CBonus@@UAE?AU_ImageIdentifierType@CImageManager@@XZ" fullword ascii
		 $a16= "?GetImage@CBullet@@UAE?AU_ImageIdentifierType@CImageManager@@XZ" fullword ascii
		 $a17= "?GetImage@CTankObj@@UAE?AU_ImageIdentifierType@CImageManager@@XZ" fullword ascii
		 $a18= "?GetRuntimeClass@CNotSupportedException@@UBEPAUCRuntimeClass@@XZ" fullword ascii
		 $a19= "?GetRuntimeClass@CResourceException@@UBEPAUCRuntimeClass@@XZ" fullword ascii
		 $a20= "?GrayCtlColor@CWnd@@SGHPAUHDC__@@PAUHWND__@@IPAUHBRUSH__@@K@Z" fullword ascii
		 $a21= "?InitModalIndirect@CDialog@@QAEHPBUDLGTEMPLATE@@PAVCWnd@@PAX@Z" fullword ascii
		 $a22= "?_interfaceEntries@CCmdTarget@@0QBUAFX_INTERFACEMAP_ENTRY@@B" fullword ascii
		 $a23= "?UpdateImage@CImageManager@@QAEXAAU_ImageIdentifierType@1@AAH@Z" fullword ascii

		 $hex1= {246131303d20223f5f}
		 $hex2= {246131313d20223f47}
		 $hex3= {246131323d20223f47}
		 $hex4= {246131333d20223f47}
		 $hex5= {246131343d20223f47}
		 $hex6= {246131353d20223f47}
		 $hex7= {246131363d20223f47}
		 $hex8= {246131373d20223f47}
		 $hex9= {246131383d20223f47}
		 $hex10= {246131393d20223f47}
		 $hex11= {2461313d20223f4166}
		 $hex12= {246132303d20223f47}
		 $hex13= {246132313d20223f49}
		 $hex14= {246132323d20223f5f}
		 $hex15= {246132333d20223f55}
		 $hex16= {2461323d20223f4265}
		 $hex17= {2461333d20223f3f5f}
		 $hex18= {2461343d20223f3f5f}
		 $hex19= {2461353d20223f636c}
		 $hex20= {2461363d20223f636c}
		 $hex21= {2461373d20223f5f63}
		 $hex22= {2461383d20223f4372}
		 $hex23= {2461393d20223f4472}

	condition:
		15 of them
}
