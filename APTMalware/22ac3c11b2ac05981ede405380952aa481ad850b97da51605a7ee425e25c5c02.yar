
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_1_22ac3c11b2ac05981ede405380952aa481ad850b97da51605a7ee425e25c5c02 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_1_22ac3c11b2ac05981ede405380952aa481ad850b97da51605a7ee425e25c5c02 {
	meta: 
		 description= "APTMalware_APT_1_22ac3c11b2ac05981ede405380952aa481ad850b97da51605a7ee425e25c5c02 Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-38-35" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "d4ba6430996fb4021241efc97c607504"

	strings:

	
 		 $s1= "@Base Taille Module Path" fullword wide
		 $s2= "CAPIPRIVATEBLOB" fullword wide
		 $s3= "CERT_SYSTEM_STORE_CURRENT_SERVICE" fullword wide
		 $s4= "CERT_SYSTEM_STORE_CURRENT_USER" fullword wide
		 $s5= "CERT_SYSTEM_STORE_LOCAL_MACHINE" fullword wide
		 $s6= "CERT_SYSTEM_STORE_SERVICES" fullword wide
		 $s7= "CERT_SYSTEM_STORE_USERS" fullword wide
		 $s8= "CONTINUE_PENDING" fullword wide
		 $s9= "DisableRegistryTools" fullword wide
		 $s10= "DOMAIN_CERTIFICATE" fullword wide
		 $s11= "DOMAIN_EXTENDED" fullword wide
		 $s12= "DOMAIN_PASSWORD" fullword wide
		 $s13= "DOMAIN_VISIBLE_PASSWORD" fullword wide
		 $s14= "ENABLED_BY_DEFAULT " fullword wide
		 $s15= "es d'identification" fullword wide
		 $s16= "exportCertificates" fullword wide
		 $s17= "FileDescription" fullword wide
		 $s18= "FILE_SYSTEM_DRIVER" fullword wide
		 $s19= "ge AssignPrimaryToken" fullword wide
		 $s20= "GENERIC_CERTIFICAT" fullword wide

		 $hex1= {40??42??61??73??65??20??54??61??69??6c??6c??65??20??4d??6f??64??75??6c??65??20??50??61??74??68??0a??}
		 $hex2= {43??41??50??49??50??52??49??56??41??54??45??42??4c??4f??42??0a??}
		 $hex3= {43??45??52??54??5f??53??59??53??54??45??4d??5f??53??54??4f??52??45??5f??43??55??52??52??45??4e??54??5f??53??45??52??56??}
		 $hex4= {43??45??52??54??5f??53??59??53??54??45??4d??5f??53??54??4f??52??45??5f??43??55??52??52??45??4e??54??5f??55??53??45??52??}
		 $hex5= {43??45??52??54??5f??53??59??53??54??45??4d??5f??53??54??4f??52??45??5f??4c??4f??43??41??4c??5f??4d??41??43??48??49??4e??}
		 $hex6= {43??45??52??54??5f??53??59??53??54??45??4d??5f??53??54??4f??52??45??5f??53??45??52??56??49??43??45??53??0a??}
		 $hex7= {43??45??52??54??5f??53??59??53??54??45??4d??5f??53??54??4f??52??45??5f??55??53??45??52??53??0a??}
		 $hex8= {43??4f??4e??54??49??4e??55??45??5f??50??45??4e??44??49??4e??47??0a??}
		 $hex9= {44??4f??4d??41??49??4e??5f??43??45??52??54??49??46??49??43??41??54??45??0a??}
		 $hex10= {44??4f??4d??41??49??4e??5f??45??58??54??45??4e??44??45??44??0a??}
		 $hex11= {44??4f??4d??41??49??4e??5f??50??41??53??53??57??4f??52??44??0a??}
		 $hex12= {44??4f??4d??41??49??4e??5f??56??49??53??49??42??4c??45??5f??50??41??53??53??57??4f??52??44??0a??}
		 $hex13= {44??69??73??61??62??6c??65??52??65??67??69??73??74??72??79??54??6f??6f??6c??73??0a??}
		 $hex14= {45??4e??41??42??4c??45??44??5f??42??59??5f??44??45??46??41??55??4c??54??0a??}
		 $hex15= {46??49??4c??45??5f??53??59??53??54??45??4d??5f??44??52??49??56??45??52??0a??}
		 $hex16= {46??69??6c??65??44??65??73??63??72??69??70??74??69??6f??6e??0a??}
		 $hex17= {47??45??4e??45??52??49??43??5f??43??45??52??54??49??46??49??43??41??54??0a??}
		 $hex18= {65??73??20??64??27??69??64??65??6e??74??69??66??69??63??61??74??69??6f??6e??0a??}
		 $hex19= {65??78??70??6f??72??74??43??65??72??74??69??66??69??63??61??74??65??73??0a??}
		 $hex20= {67??65??20??41??73??73??69??67??6e??50??72??69??6d??61??72??79??54??6f??6b??65??6e??0a??}

	condition:
		22 of them
}
