
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_19 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_19 {
	meta: 
		 description= "APTMalware_APT_19 Group" 
		 author = "Resteex Generator" 
		 date = "2022-01-21_23-58-54" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "02fab24461956458d70aeed1a028eb9c"
		 hash2= "0a9545f9fc7a6d8596cf07a59f400fd3"
		 hash3= "14c04f88dc97aef3e9b516ef208a2bf5"
		 hash4= "16652d4213991ae58e268ae03a4c4e97"
		 hash5= "1cb673679f37b6a3f482bb59b52423ab"
		 hash6= "1faf6402f643c306bba4aa50c536f4e1"
		 hash7= "22823fed979903f8dfe3b5d28537eb47"
		 hash8= "230d8a7a60a07df28a291b13ddf3351f"
		 hash9= "24e9870973cea42e6faf705b14208e52"
		 hash10= "26e863f917da0b3f7a48304eb6d1b1d3"
		 hash11= "2b5b8070c460bb085921eb3a9e12fa87"
		 hash12= "2c7bad4f4a4df3025aa1345db27c7408"
		 hash13= "2dce7fc3f52a692d8a84a0c182519133"
		 hash14= "3e4fbb9190227848af32dacb17e9fd17"
		 hash15= "3f3d35208bfe32e64f82593ee89ff462"
		 hash16= "422f3353164aae7afa7429e6721703cc"
		 hash17= "47619fca20895abc83807321cbb80a3d"
		 hash18= "4a23e0f2c6f926a41b28d574cbc6ac30"
		 hash19= "52a1b0de364dfa9bafabde0c07bd90c2"
		 hash20= "6668e339d1f11a724aa286593c192472"
		 hash21= "740561c8d5d2c658d2134d5107802a9d"
		 hash22= "7f466312a3b1176f052f8c05f7781715"
		 hash23= "8afecc8e61fe3805fdd41d4591710976"
		 hash24= "8ee244ad6b6f2b814d34d26dae880f12"
		 hash25= "98721c78dfbf8a45d152a888c804427c"
		 hash26= "9b66d0c215af19241631673bd6d9c7d9"
		 hash27= "a26e600652c33dd054731b4693bf5b01"
		 hash28= "b93197e2aa147fe6b70695ae7bb298b0"
		 hash29= "cd8c2bb644496d46bf1e91ad8a8f882b"
		 hash30= "dae6b9b3b8e39b08b10a51a6457444d8"
		 hash31= "de7500fc1065a081180841f32f06a537"
		 hash32= "e81f9dadbdc7eea937e586afc9fb59f8"

	strings:

	
 		 $s1= "%08lX%04X%04x%02X%02X%02X%02X%02X%02X%02X%02X" fullword wide
		 $s2= "%08lX-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X" fullword wide
		 $s3= "%2protocolStdFileEditingserver" fullword wide
		 $s4= "%2protocolStdFileEditingverb0" fullword wide
		 $s5= "{3n{y#3n{y#3n{y#3n{y#3n{y#3n{y#3" fullword wide
		 $s6= "6.2.9200.16384 (win8_rtm.120725-1247)" fullword wide
		 $s7= "{6AB5E732-DFA9-4618-AF1C-F0D9DEF0E222}" fullword wide
		 $s8= "{AE2A3887-A30A-4B39-A5E6-AC891A07AFF3}" fullword wide
		 $s9= "AFX_WM_CHANGE_CURRENT_FOLDER" fullword wide
		 $s10= "AFX_WM_CHANGEVISUALMANAGER" fullword wide
		 $s11= "AFX_WM_ON_AFTER_SHELL_COMMAND" fullword wide
		 $s12= "AFX_WM_ON_BEFORE_SHOW_RIBBON_ITEM_MENU" fullword wide
		 $s13= "AFX_WM_ONCHANGE_ACTIVE_TAB" fullword wide
		 $s14= "AFX_WM_ON_CHANGE_RIBBON_CATEGORY" fullword wide
		 $s15= "AFX_WM_ON_CHANGING_ACTIVE_TAB" fullword wide
		 $s16= "AFX_WM_ON_GET_TAB_TOOLTIP" fullword wide
		 $s17= "AFX_WM_ON_HIGHLIGHT_RIBBON_LIST_ITEM" fullword wide
		 $s18= "AFX_WM_ON_MOVETABCOMPLETE" fullword wide
		 $s19= "AFX_WM_ON_PRESS_CLOSE_BUTTON" fullword wide
		 $s20= "AFX_WM_ON_RIBBON_CUSTOMIZE" fullword wide
		 $s21= "AFX_WM_ON_TABGROUPMOUSEMOVE" fullword wide
		 $s22= "AFX_WM_POSTSETPREVIEWFRAME" fullword wide
		 $s23= "BaseNamedObjects{8CB2ff21-0166-4cf1-BD8F-E190BC7902DC}" fullword wide
		 $s24= "CDockingPaneAndPaneDividers" fullword wide
		 $s25= "CLSID%1DefaultExtension" fullword wide
		 $s26= "commdlg_LBSelChangedNotify" fullword wide
		 $s27= "ConsentPromptBehaviorAdmin" fullword wide
		 $s28= "C:WindowsSystem32sysprep" fullword wide
		 $s29= "C:WindowsSystem32sysprepCRYPTBASE.dll" fullword wide
		 $s30= "C:WindowsSystem32sysprepsysprep.exe" fullword wide
		 $s31= "DMFCMaskedEdit_ValidChars" fullword wide
		 $s32= "ENABLE_TOOLTIPS_DESCRIPTION" fullword wide
		 $s33= "Enpi)Vmrqs$Mmnm-Bivesahl$Dvirev" fullword wide
		 $s34= "f:ddvctoolsvc7libsshipatlmfcincludeafxwin1.inl" fullword wide
		 $s35= "f:ddvctoolsvc7libsshipatlmfcincludeafxwin2.inl" fullword wide
		 $s36= "f:ddvctoolsvc7libsshipatlmfcsrcmfcappcore.cpp" fullword wide
		 $s37= "f:ddvctoolsvc7libsshipatlmfcsrcmfcarray_s.cpp" fullword wide
		 $s38= "@f:ddvctoolsvc7libsshipatlmfcsrcmfcauxdata.cpp" fullword wide
		 $s39= "f:ddvctoolsvc7libsshipatlmfcsrcmfcauxdata.cpp" fullword wide
		 $s40= "@f:ddvctoolsvc7libsshipatlmfcsrcmfcfilecore.cpp" fullword wide
		 $s41= "f:ddvctoolsvc7libsshipatlmfcsrcmfcoleipfrm.cpp" fullword wide
		 $s42= "f:ddvctoolsvc7libsshipatlmfcsrcmfcolestrm.cpp" fullword wide
		 $s43= "f:ddvctoolsvc7libsshipatlmfcsrcmfcviewcore.cpp" fullword wide
		 $s44= "f:ddvctoolsvc7libsshipatlmfcsrcmfcwinctrl2.cpp" fullword wide
		 $s45= "f:ddvctoolsvc7libsshipatlmfcsrcmfcwinfrm.cpp" fullword wide
		 $s46= "FMFCShellTreeCtrl_EnableShellContextMenu" fullword wide
		 $s47= "http://myip.dnsomatic.com/" fullword wide
		 $s48= "L$_RasDefaultCredentials#0" fullword wide
		 $s49= "@MFCColorButton_ColumnsCount" fullword wide
		 $s50= "MFCColorButton_EnableAutomaticButton" fullword wide
		 $s51= "MFCColorButton_EnableOtherButton" fullword wide
		 $s52= "MFCComboBox_DrawUsingFont" fullword wide
		 $s53= "@MFCComboBox_ShowDeviceTypeFonts" fullword wide
		 $s54= "MFCComboBox_ShowRasterTypeFonts" fullword wide
		 $s55= "MFCComboBox_ShowTrueTypeFonts" fullword wide
		 $s56= "MFCMaskedEdit_DefaultChar" fullword wide
		 $s57= "MFCMaskedEdit_InputTemplate" fullword wide
		 $s58= "MFCMaskedEdit_SelectByGroup" fullword wide
		 $s59= "MFCMenuButton_DefaultClick" fullword wide
		 $s60= "MFCMenuButton_StayPressed" fullword wide
		 $s61= "MFCPropertyGrid_AlphabeticMode" fullword wide
		 $s62= "MFCPropertyGrid_DescriptionArea" fullword wide
		 $s63= "MFCPropertyGrid_DescriptionRows" fullword wide
		 $s64= "MFCPropertyGrid_HeaderCtrl" fullword wide
		 $s65= "MFCPropertyGrid_ModifiedProperties" fullword wide
		 $s66= "MFCPropertyGrid_VSDotNetLook" fullword wide
		 $s67= "MFCShellListCtrl_EnableShellContextMenu" fullword wide
		 $s68= "MFCVSListbox_BrowseButton" fullword wide
		 $s69= "MFCVSListbox_RemoveButton" fullword wide
		 $s70= "Nf:ddvctoolsvc7libsshipatlmfcsrcmfcoledrop2.cpp" fullword wide
		 $s71= "NTOOLBAR__GETDOCUMENTCOLORS" fullword wide
		 $s72= "Preparing Installation..." fullword wide
		 $s73= "REGISTRYMachineSoftwareNovell" fullword wide
		 $s74= "REGISTRYMACHINESYSTEMControlSet001Services" fullword wide
		 $s75= "RegistryMachineSYSTEMCurrentControlSetControlWMI" fullword wide
		 $s76= "RegistryMachineSystemCurrentControlSetServices" fullword wide
		 $s77= "%sDockablePaneAdapter-%d%x" fullword wide
		 $s78= "SeAssignPrimaryTokenPrivilege" fullword wide
		 $s79= "SOFTWAREMicrosoftInternet Explorer" fullword wide
		 $s80= "SoftwareMicrosoftWindowsCurrentVersionInternet Settings" fullword wide
		 $s81= "SOFTWAREMicrosoftWindowsCurrentVersionInternet Settings5.0" fullword wide
		 $s82= "SoftwareMicrosoftWindowsCurrentVersionPoliciesComdlg32" fullword wide
		 $s83= "SoftwareMicrosoftWindowsCurrentVersionPoliciesExplorer" fullword wide
		 $s84= "SoftwareMicrosoftWindowsCurrentVersionPoliciesNetwork" fullword wide
		 $s85= "SOFTWAREMicrosoftWindowsCurrentVersionPoliciesSystem" fullword wide
		 $s86= "sSYSTEMCurrentControlSetServices" fullword wide
		 $s87= "SYSTEMCurrentControlSetControlPnp" fullword wide
		 $s88= "SystemCurrentControlSetServices" fullword wide
		 $s89= "SYSTEMCurrentControlSetServices" fullword wide
		 $s90= "U_i=V`j>Wak?Xbl@YcmAZdnB[eoCfpD]gq" fullword wide
		 $s91= "%WINDIR%PCHealthHelpCtrBinariespchsvc.dll" fullword wide
		 $s92= "WINDOWSSYSTEM32INETSRVW3WP.EXE" fullword wide
		 $s93= "WINDOWSSYSTEM32WINLOGON.EXE" fullword wide
		 $s94= ";WV" fullword wide
		 $s95= "WYWCKRA.54*4*0*412$F57(F58" fullword wide
		 $a1= "LQgiBpZcu/Br5mZudO12J76Wv2aM+fMl9owZzKiXLA+91PkiFocyvGpyGIjkJNFw" fullword ascii
		 $a2= "MIIBCAKCAQEAraWJCGOetmHnY0QnEbybkBR2JDGA9wWSyXPkA1GDsLB0/nM5vHIX" fullword ascii

		 $hex1= {2461313d20224c5167}
		 $hex2= {2461323d20224d4949}
		 $hex3= {247331303d20224146}
		 $hex4= {247331313d20224146}
		 $hex5= {247331323d20224146}
		 $hex6= {247331333d20224146}
		 $hex7= {247331343d20224146}
		 $hex8= {247331353d20224146}
		 $hex9= {247331363d20224146}
		 $hex10= {247331373d20224146}
		 $hex11= {247331383d20224146}
		 $hex12= {247331393d20224146}
		 $hex13= {2473313d2022253038}
		 $hex14= {247332303d20224146}
		 $hex15= {247332313d20224146}
		 $hex16= {247332323d20224146}
		 $hex17= {247332333d20224261}
		 $hex18= {247332343d20224344}
		 $hex19= {247332353d2022434c}
		 $hex20= {247332363d2022636f}
		 $hex21= {247332373d2022436f}
		 $hex22= {247332383d2022433a}
		 $hex23= {247332393d2022433a}
		 $hex24= {2473323d2022253038}
		 $hex25= {247333303d2022433a}
		 $hex26= {247333313d2022444d}
		 $hex27= {247333323d2022454e}
		 $hex28= {247333333d2022456e}
		 $hex29= {247333343d2022663a}
		 $hex30= {247333353d2022663a}
		 $hex31= {247333363d2022663a}
		 $hex32= {247333373d2022663a}
		 $hex33= {247333383d20224066}
		 $hex34= {247333393d2022663a}
		 $hex35= {2473333d2022253270}
		 $hex36= {247334303d20224066}
		 $hex37= {247334313d2022663a}
		 $hex38= {247334323d2022663a}
		 $hex39= {247334333d2022663a}
		 $hex40= {247334343d2022663a}
		 $hex41= {247334353d2022663a}
		 $hex42= {247334363d2022464d}
		 $hex43= {247334373d20226874}
		 $hex44= {247334383d20224c24}
		 $hex45= {247334393d2022404d}
		 $hex46= {2473343d2022253270}
		 $hex47= {247335303d20224d46}
		 $hex48= {247335313d20224d46}
		 $hex49= {247335323d20224d46}
		 $hex50= {247335333d2022404d}
		 $hex51= {247335343d20224d46}
		 $hex52= {247335353d20224d46}
		 $hex53= {247335363d20224d46}
		 $hex54= {247335373d20224d46}
		 $hex55= {247335383d20224d46}
		 $hex56= {247335393d20224d46}
		 $hex57= {2473353d20227b336e}
		 $hex58= {247336303d20224d46}
		 $hex59= {247336313d20224d46}
		 $hex60= {247336323d20224d46}
		 $hex61= {247336333d20224d46}
		 $hex62= {247336343d20224d46}
		 $hex63= {247336353d20224d46}
		 $hex64= {247336363d20224d46}
		 $hex65= {247336373d20224d46}
		 $hex66= {247336383d20224d46}
		 $hex67= {247336393d20224d46}
		 $hex68= {2473363d2022362e32}
		 $hex69= {247337303d20224e66}
		 $hex70= {247337313d20224e54}
		 $hex71= {247337323d20225072}
		 $hex72= {247337333d20225245}
		 $hex73= {247337343d20225245}
		 $hex74= {247337353d20225265}
		 $hex75= {247337363d20225265}
		 $hex76= {247337373d20222573}
		 $hex77= {247337383d20225365}
		 $hex78= {247337393d2022534f}
		 $hex79= {2473373d20227b3641}
		 $hex80= {247338303d2022536f}
		 $hex81= {247338313d2022534f}
		 $hex82= {247338323d2022536f}
		 $hex83= {247338333d2022536f}
		 $hex84= {247338343d2022536f}
		 $hex85= {247338353d2022534f}
		 $hex86= {247338363d20227353}
		 $hex87= {247338373d20225359}
		 $hex88= {247338383d20225379}
		 $hex89= {247338393d20225359}
		 $hex90= {2473383d20227b4145}
		 $hex91= {247339303d2022555f}
		 $hex92= {247339313d20222557}
		 $hex93= {247339323d20225749}
		 $hex94= {247339333d20225749}
		 $hex95= {247339343d20223b57}
		 $hex96= {247339353d20225759}
		 $hex97= {2473393d2022414658}

	condition:
		20 of them
}
