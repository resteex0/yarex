
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_Winnti_0832ec4e7a6e59fe03fe7d7614eadd67ceea3f330b309cadb4aacaf05d46ba61 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_Winnti_0832ec4e7a6e59fe03fe7d7614eadd67ceea3f330b309cadb4aacaf05d46ba61 {
	meta: 
		 description= "APTMalware_Winnti_0832ec4e7a6e59fe03fe7d7614eadd67ceea3f330b309cadb4aacaf05d46ba61 Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-57-29" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "afe4ec9a88f84fbf9c1eb0f3ff47a12b"

	strings:

	
 		 $s1= "Advanced Server" fullword wide
		 $s2= "Business Edition" fullword wide
		 $s3= "C:windowsproerr.log" fullword wide
		 $s4= "C:windowssetupapi.dll" fullword wide
		 $s5= "C:windowssystem32setupapi.dll" fullword wide
		 $s6= "Datacenter Edition" fullword wide
		 $s7= "Datacenter Server" fullword wide
		 $s8= "DeviceCabViewer" fullword wide
		 $s9= "Disk Information:" fullword wide
		 $s10= "DosDevicesCabViewer" fullword wide
		 $s11= "Enterprise Edition" fullword wide
		 $s12= "Organization: %s" fullword wide
		 $s13= "ProcessorNameString" fullword wide
		 $s14= "rD:ZeusServer.txt" fullword wide
		 $s15= "RegisteredOrganization" fullword wide
		 $s16= "RegisteredOwner" fullword wide
		 $s17= "Standard Edition" fullword wide
		 $s18= "Starter Edition" fullword wide
		 $s19= "Ultimate Edition" fullword wide

		 $hex1= {41??64??76??61??6e??63??65??64??20??53??65??72??76??65??72??0a??}
		 $hex2= {42??75??73??69??6e??65??73??73??20??45??64??69??74??69??6f??6e??0a??}
		 $hex3= {43??3a??77??69??6e??64??6f??77??73??70??72??6f??65??72??72??2e??6c??6f??67??0a??}
		 $hex4= {43??3a??77??69??6e??64??6f??77??73??73??65??74??75??70??61??70??69??2e??64??6c??6c??0a??}
		 $hex5= {43??3a??77??69??6e??64??6f??77??73??73??79??73??74??65??6d??33??32??73??65??74??75??70??61??70??69??2e??64??6c??6c??0a??}
		 $hex6= {44??61??74??61??63??65??6e??74??65??72??20??45??64??69??74??69??6f??6e??0a??}
		 $hex7= {44??61??74??61??63??65??6e??74??65??72??20??53??65??72??76??65??72??0a??}
		 $hex8= {44??65??76??69??63??65??43??61??62??56??69??65??77??65??72??0a??}
		 $hex9= {44??69??73??6b??20??49??6e??66??6f??72??6d??61??74??69??6f??6e??3a??0a??}
		 $hex10= {44??6f??73??44??65??76??69??63??65??73??43??61??62??56??69??65??77??65??72??0a??}
		 $hex11= {45??6e??74??65??72??70??72??69??73??65??20??45??64??69??74??69??6f??6e??0a??}
		 $hex12= {4f??72??67??61??6e??69??7a??61??74??69??6f??6e??3a??20??25??73??0a??}
		 $hex13= {50??72??6f??63??65??73??73??6f??72??4e??61??6d??65??53??74??72??69??6e??67??0a??}
		 $hex14= {52??65??67??69??73??74??65??72??65??64??4f??72??67??61??6e??69??7a??61??74??69??6f??6e??0a??}
		 $hex15= {52??65??67??69??73??74??65??72??65??64??4f??77??6e??65??72??0a??}
		 $hex16= {53??74??61??6e??64??61??72??64??20??45??64??69??74??69??6f??6e??0a??}
		 $hex17= {53??74??61??72??74??65??72??20??45??64??69??74??69??6f??6e??0a??}
		 $hex18= {55??6c??74??69??6d??61??74??65??20??45??64??69??74??69??6f??6e??0a??}
		 $hex19= {72??44??3a??5a??65??75??73??53??65??72??76??65??72??2e??74??78??74??0a??}

	condition:
		21 of them
}
