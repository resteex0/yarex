
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_21_f4181bf1306d0124ac9c7e65dd2a56d7109676cf3a04d4d6c3e82f7d9648b7ef 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_21_f4181bf1306d0124ac9c7e65dd2a56d7109676cf3a04d4d6c3e82f7d9648b7ef {
	meta: 
		 description= "APTMalware_APT_21_f4181bf1306d0124ac9c7e65dd2a56d7109676cf3a04d4d6c3e82f7d9648b7ef Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-28-35" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "d04a7f30c83290b86cac8d762dcc2df5"

	strings:

	
 		 $s1= "FileDescription" fullword wide
		 $s2= "OriginalFilename" fullword wide
		 $s3= "sysprepCRYPTBASE.dll" fullword wide
		 $s4= "sysprepsysprep.exe" fullword wide
		 $s5= "VS_VERSION_INFO" fullword wide
		 $s6= "Win7ElevateDLL.dll" fullword wide
		 $s7= "Win7Elevate.exe" fullword wide
		 $s8= "Win7Elevate proof-of-concept" fullword wide

		 $hex1= {46??69??6c??65??44??65??73??63??72??69??70??74??69??6f??6e??0a??}
		 $hex2= {4f??72??69??67??69??6e??61??6c??46??69??6c??65??6e??61??6d??65??0a??}
		 $hex3= {56??53??5f??56??45??52??53??49??4f??4e??5f??49??4e??46??4f??0a??}
		 $hex4= {57??69??6e??37??45??6c??65??76??61??74??65??20??70??72??6f??6f??66??2d??6f??66??2d??63??6f??6e??63??65??70??74??0a??}
		 $hex5= {57??69??6e??37??45??6c??65??76??61??74??65??2e??65??78??65??0a??}
		 $hex6= {57??69??6e??37??45??6c??65??76??61??74??65??44??4c??4c??2e??64??6c??6c??0a??}
		 $hex7= {73??79??73??70??72??65??70??43??52??59??50??54??42??41??53??45??2e??64??6c??6c??0a??}
		 $hex8= {73??79??73??70??72??65??70??73??79??73??70??72??65??70??2e??65??78??65??0a??}

	condition:
		8 of them
}
