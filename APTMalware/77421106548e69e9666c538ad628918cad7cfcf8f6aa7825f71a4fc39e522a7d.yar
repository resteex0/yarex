
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_19_77421106548e69e9666c538ad628918cad7cfcf8f6aa7825f71a4fc39e522a7d 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_19_77421106548e69e9666c538ad628918cad7cfcf8f6aa7825f71a4fc39e522a7d {
	meta: 
		 description= "APTMalware_APT_19_77421106548e69e9666c538ad628918cad7cfcf8f6aa7825f71a4fc39e522a7d Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-52-03" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "0a9545f9fc7a6d8596cf07a59f400fd3"

	strings:

	
 		 $s1= "ConsentPromptBehaviorAdmin" fullword wide
		 $s2= "C:WindowsSystem32sysprep" fullword wide
		 $s3= "FileDescription" fullword wide
		 $s4= "HTTPMail Password2" fullword wide
		 $s5= "Microsoft Corporation" fullword wide
		 $s6= "Microsoft update" fullword wide
		 $s7= "Microsoft_WinInet_" fullword wide
		 $s8= "sysprepsysprep.exe" fullword wide
		 $s9= "SystemCurrentControlSetServices" fullword wide
		 $s10= "SYSTEMCurrentControlSetServices" fullword wide
		 $s11= "VS_VERSION_INFO" fullword wide

		 $hex1= {43??3a??57??69??6e??64??6f??77??73??53??79??73??74??65??6d??33??32??73??79??73??70??72??65??70??0a??}
		 $hex2= {43??6f??6e??73??65??6e??74??50??72??6f??6d??70??74??42??65??68??61??76??69??6f??72??41??64??6d??69??6e??0a??}
		 $hex3= {46??69??6c??65??44??65??73??63??72??69??70??74??69??6f??6e??0a??}
		 $hex4= {48??54??54??50??4d??61??69??6c??20??50??61??73??73??77??6f??72??64??32??0a??}
		 $hex5= {4d??69??63??72??6f??73??6f??66??74??20??43??6f??72??70??6f??72??61??74??69??6f??6e??0a??}
		 $hex6= {4d??69??63??72??6f??73??6f??66??74??20??75??70??64??61??74??65??0a??}
		 $hex7= {4d??69??63??72??6f??73??6f??66??74??5f??57??69??6e??49??6e??65??74??5f??0a??}
		 $hex8= {53??59??53??54??45??4d??43??75??72??72??65??6e??74??43??6f??6e??74??72??6f??6c??53??65??74??53??65??72??76??69??63??65??}
		 $hex9= {53??79??73??74??65??6d??43??75??72??72??65??6e??74??43??6f??6e??74??72??6f??6c??53??65??74??53??65??72??76??69??63??65??}
		 $hex10= {56??53??5f??56??45??52??53??49??4f??4e??5f??49??4e??46??4f??0a??}
		 $hex11= {73??79??73??70??72??65??70??73??79??73??70??72??65??70??2e??65??78??65??0a??}

	condition:
		12 of them
}
