
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_Dark_Hotel_d6a684b35cac3b7d434187a4623cf4c17864327968aa05a6ee58d89ba6ed9f1c 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_Dark_Hotel_d6a684b35cac3b7d434187a4623cf4c17864327968aa05a6ee58d89ba6ed9f1c {
	meta: 
		 description= "APTMalware_Dark_Hotel_d6a684b35cac3b7d434187a4623cf4c17864327968aa05a6ee58d89ba6ed9f1c Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-16-23" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "752c351778a8a18245f132dafdc54599"

	strings:

	
 		 $s1= "%2protocolStdFileEditingserver" fullword wide
		 $s2= "%2protocolStdFileEditingverb0" fullword wide
		 $s3= "accDefaultAction" fullword wide
		 $s4= "accDoDefaultAction" fullword wide
		 $s5= "accKeyboardShortcut" fullword wide
		 $s6= "AfxClosePending" fullword wide
		 $s7= "AfxControlBar100su" fullword wide
		 $s8= "AfxFrameOrView100su" fullword wide
		 $s9= "AfxMDIFrame100su" fullword wide
		 $s10= "AfxOldWndProc423" fullword wide
		 $s11= "AfxOleControl100su" fullword wide
		 $s12= "AFX_SUPERBAR_TAB" fullword wide
		 $s13= "AFX_WM_CHANGE_CURRENT_FOLDER" fullword wide
		 $s14= "AFX_WM_CHANGEVISUALMANAGER" fullword wide
		 $s15= "AFX_WM_GETDRAGBOUNDS" fullword wide
		 $s16= "@AFX_WM_ON_AFTER_SHELL_COMMAND" fullword wide
		 $s17= "AFX_WM_ON_CANCELTABMOVE" fullword wide
		 $s18= "AFX_WM_ONCHANGE_ACTIVE_TAB" fullword wide
		 $s19= "AFX_WM_ON_CHANGE_RIBBON_CATEGORY" fullword wide
		 $s20= "AFX_WM_ON_CHANGING_ACTIVE_TAB" fullword wide

		 $hex1= {25??32??70??72??6f??74??6f??63??6f??6c??53??74??64??46??69??6c??65??45??64??69??74??69??6e??67??73??65??72??76??65??72??}
		 $hex2= {25??32??70??72??6f??74??6f??63??6f??6c??53??74??64??46??69??6c??65??45??64??69??74??69??6e??67??76??65??72??62??30??0a??}
		 $hex3= {40??41??46??58??5f??57??4d??5f??4f??4e??5f??41??46??54??45??52??5f??53??48??45??4c??4c??5f??43??4f??4d??4d??41??4e??44??}
		 $hex4= {41??46??58??5f??53??55??50??45??52??42??41??52??5f??54??41??42??0a??}
		 $hex5= {41??46??58??5f??57??4d??5f??43??48??41??4e??47??45??56??49??53??55??41??4c??4d??41??4e??41??47??45??52??0a??}
		 $hex6= {41??46??58??5f??57??4d??5f??43??48??41??4e??47??45??5f??43??55??52??52??45??4e??54??5f??46??4f??4c??44??45??52??0a??}
		 $hex7= {41??46??58??5f??57??4d??5f??47??45??54??44??52??41??47??42??4f??55??4e??44??53??0a??}
		 $hex8= {41??46??58??5f??57??4d??5f??4f??4e??43??48??41??4e??47??45??5f??41??43??54??49??56??45??5f??54??41??42??0a??}
		 $hex9= {41??46??58??5f??57??4d??5f??4f??4e??5f??43??41??4e??43??45??4c??54??41??42??4d??4f??56??45??0a??}
		 $hex10= {41??46??58??5f??57??4d??5f??4f??4e??5f??43??48??41??4e??47??45??5f??52??49??42??42??4f??4e??5f??43??41??54??45??47??4f??}
		 $hex11= {41??46??58??5f??57??4d??5f??4f??4e??5f??43??48??41??4e??47??49??4e??47??5f??41??43??54??49??56??45??5f??54??41??42??0a??}
		 $hex12= {41??66??78??43??6c??6f??73??65??50??65??6e??64??69??6e??67??0a??}
		 $hex13= {41??66??78??43??6f??6e??74??72??6f??6c??42??61??72??31??30??30??73??75??0a??}
		 $hex14= {41??66??78??46??72??61??6d??65??4f??72??56??69??65??77??31??30??30??73??75??0a??}
		 $hex15= {41??66??78??4d??44??49??46??72??61??6d??65??31??30??30??73??75??0a??}
		 $hex16= {41??66??78??4f??6c??64??57??6e??64??50??72??6f??63??34??32??33??0a??}
		 $hex17= {41??66??78??4f??6c??65??43??6f??6e??74??72??6f??6c??31??30??30??73??75??0a??}
		 $hex18= {61??63??63??44??65??66??61??75??6c??74??41??63??74??69??6f??6e??0a??}
		 $hex19= {61??63??63??44??6f??44??65??66??61??75??6c??74??41??63??74??69??6f??6e??0a??}
		 $hex20= {61??63??63??4b??65??79??62??6f??61??72??64??53??68??6f??72??74??63??75??74??0a??}

	condition:
		22 of them
}
