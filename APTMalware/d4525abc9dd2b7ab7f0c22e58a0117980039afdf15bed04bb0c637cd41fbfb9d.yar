
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_28_d4525abc9dd2b7ab7f0c22e58a0117980039afdf15bed04bb0c637cd41fbfb9d 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_28_d4525abc9dd2b7ab7f0c22e58a0117980039afdf15bed04bb0c637cd41fbfb9d {
	meta: 
		 description= "APTMalware_APT_28_d4525abc9dd2b7ab7f0c22e58a0117980039afdf15bed04bb0c637cd41fbfb9d Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_13-10-51" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "d535c3fc5f0f98e021bea0d6277d2559"

	strings:

	
 		 $s1= "-4f42-11e3-9712-806e6f6e6963}" fullword wide
		 $s2= "AppDataRoaming" fullword wide
		 $s3= "COMPUTERNAMEREM" fullword wide
		 $s4= "C:UsersREMDesktop" fullword wide
		 $s5= "C:UsersREMDesktopdesktop.ini" fullword wide
		 $s6= "C:UsersREMDocumentsdesktop.ini" fullword wide
		 $s7= "C:UsersREMDownloadsdesktop.ini" fullword wide
		 $s8= "C:UsersREMMusicdesktop.ini" fullword wide
		 $s9= "C:UsersREMPicturesdesktop.ini" fullword wide
		 $s10= "C:UsersREMVideosdesktop.ini" fullword wide
		 $s11= "C:WindowsLastGood" fullword wide
		 $s12= "C:WindowsSYSTEM" fullword wide
		 $s13= "C:Windowssystem32" fullword wide
		 $s14= "C:WindowsSYSTEM32bcrypt.dll" fullword wide
		 $s15= "C:Windowssystem32CFGMGR32.dll" fullword wide
		 $s16= "C:WindowsSYSTEM32CRYPTBASE.dll" fullword wide
		 $s17= "C:WindowsSYSTEM32CRYPTSP.dll" fullword wide
		 $s18= "C:WindowsSystem32desktop.ini" fullword wide
		 $s19= "C:WindowsSystem32iertutil.dll" fullword wide
		 $s20= "C:Windowssystem32OLEAUT32.dll" fullword wide

		 $hex1= {2d??34??66??34??32??2d??31??31??65??33??2d??39??37??31??32??2d??38??30??36??65??36??66??36??65??36??39??36??33??7d??0a??}
		 $hex2= {41??70??70??44??61??74??61??52??6f??61??6d??69??6e??67??0a??}
		 $hex3= {43??3a??55??73??65??72??73??52??45??4d??44??65??73??6b??74??6f??70??0a??}
		 $hex4= {43??3a??55??73??65??72??73??52??45??4d??44??65??73??6b??74??6f??70??64??65??73??6b??74??6f??70??2e??69??6e??69??0a??}
		 $hex5= {43??3a??55??73??65??72??73??52??45??4d??44??6f??63??75??6d??65??6e??74??73??64??65??73??6b??74??6f??70??2e??69??6e??69??}
		 $hex6= {43??3a??55??73??65??72??73??52??45??4d??44??6f??77??6e??6c??6f??61??64??73??64??65??73??6b??74??6f??70??2e??69??6e??69??}
		 $hex7= {43??3a??55??73??65??72??73??52??45??4d??4d??75??73??69??63??64??65??73??6b??74??6f??70??2e??69??6e??69??0a??}
		 $hex8= {43??3a??55??73??65??72??73??52??45??4d??50??69??63??74??75??72??65??73??64??65??73??6b??74??6f??70??2e??69??6e??69??0a??}
		 $hex9= {43??3a??55??73??65??72??73??52??45??4d??56??69??64??65??6f??73??64??65??73??6b??74??6f??70??2e??69??6e??69??0a??}
		 $hex10= {43??3a??57??69??6e??64??6f??77??73??4c??61??73??74??47??6f??6f??64??0a??}
		 $hex11= {43??3a??57??69??6e??64??6f??77??73??53??59??53??54??45??4d??0a??}
		 $hex12= {43??3a??57??69??6e??64??6f??77??73??53??59??53??54??45??4d??33??32??43??52??59??50??54??42??41??53??45??2e??64??6c??6c??}
		 $hex13= {43??3a??57??69??6e??64??6f??77??73??53??59??53??54??45??4d??33??32??43??52??59??50??54??53??50??2e??64??6c??6c??0a??}
		 $hex14= {43??3a??57??69??6e??64??6f??77??73??53??59??53??54??45??4d??33??32??62??63??72??79??70??74??2e??64??6c??6c??0a??}
		 $hex15= {43??3a??57??69??6e??64??6f??77??73??53??79??73??74??65??6d??33??32??64??65??73??6b??74??6f??70??2e??69??6e??69??0a??}
		 $hex16= {43??3a??57??69??6e??64??6f??77??73??53??79??73??74??65??6d??33??32??69??65??72??74??75??74??69??6c??2e??64??6c??6c??0a??}
		 $hex17= {43??3a??57??69??6e??64??6f??77??73??73??79??73??74??65??6d??33??32??0a??}
		 $hex18= {43??3a??57??69??6e??64??6f??77??73??73??79??73??74??65??6d??33??32??43??46??47??4d??47??52??33??32??2e??64??6c??6c??0a??}
		 $hex19= {43??3a??57??69??6e??64??6f??77??73??73??79??73??74??65??6d??33??32??4f??4c??45??41??55??54??33??32??2e??64??6c??6c??0a??}
		 $hex20= {43??4f??4d??50??55??54??45??52??4e??41??4d??45??52??45??4d??0a??}

	condition:
		22 of them
}
