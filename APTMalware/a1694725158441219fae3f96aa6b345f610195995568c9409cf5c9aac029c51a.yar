
/*
   YARA Rule Set
   Author: resteex
   Identifier: APTMalware_APT_1_a1694725158441219fae3f96aa6b345f610195995568c9409cf5c9aac029c51a 
   /
/* Rule Set ----------------------------------------------------------------- */

rule resteex_APTMalware_APT_1_a1694725158441219fae3f96aa6b345f610195995568c9409cf5c9aac029c51a {
	meta: 
		 description= "APTMalware_APT_1_a1694725158441219fae3f96aa6b345f610195995568c9409cf5c9aac029c51a Group" 
		 author = "Resteex Generator" 
		 date = "2022-03-28_12-43-12" 
		 license = "https://github.com/resteex0/yarex"
		 hash1= "70a55fdc712c6e31e013e6b5d412b0d6"

	strings:

	
 		 $s1= "&()[]{}^=;!%'+,`~" fullword wide
		 $s2= "%02d%s%02d%s%02d" fullword wide
		 $s3= "%2d%s%02d%s%02d%s%02d" fullword wide
		 $s4= "5.1.2600.5512 (xpsp.080413-2111)" fullword wide
		 $s5= "ASSOC [.ext[=[fileType]]]" fullword wide
		 $s6= "%%CMDEXTVERSION%% " fullword wide
		 $s7= ".COM;.EXE;.BAT;.CMD;.VBS;.JS;.WS" fullword wide
		 $s8= "command execution." fullword wide
		 $s9= "control character." fullword wide
		 $s10= "DelayedExpansion" fullword wide
		 $s11= "DISABLEDELAYEDEXPANSION" fullword wide
		 $s12= "DISABLEEXTENSIONS" fullword wide
		 $s13= "DISABLEEXTENSIONS " fullword wide
		 $s14= "DisableUNCCheck" fullword wide
		 $s15= "ENABLEDELAYEDEXPANSION" fullword wide
		 $s16= "EnableExtensions" fullword wide
		 $s17= "FileDescription" fullword wide
		 $s18= "MD [drive:]path" fullword wide
		 $s19= "Microsoft Corporation" fullword wide
		 $s20= "Missing operand." fullword wide

		 $hex1= {25??25??43??4d??44??45??58??54??56??45??52??53??49??4f??4e??25??25??0a??}
		 $hex2= {25??30??32??64??25??73??25??30??32??64??25??73??25??30??32??64??0a??}
		 $hex3= {25??32??64??25??73??25??30??32??64??25??73??25??30??32??64??25??73??25??30??32??64??0a??}
		 $hex4= {26??28??29??5b??5d??7b??7d??5e??3d??3b??21??25??27??2b??2c??60??7e??0a??}
		 $hex5= {2e??43??4f??4d??3b??2e??45??58??45??3b??2e??42??41??54??3b??2e??43??4d??44??3b??2e??56??42??53??3b??2e??4a??53??3b??2e??}
		 $hex6= {35??2e??31??2e??32??36??30??30??2e??35??35??31??32??20??28??78??70??73??70??2e??30??38??30??34??31??33??2d??32??31??31??}
		 $hex7= {41??53??53??4f??43??20??5b??2e??65??78??74??5b??3d??5b??66??69??6c??65??54??79??70??65??5d??5d??5d??0a??}
		 $hex8= {44??49??53??41??42??4c??45??44??45??4c??41??59??45??44??45??58??50??41??4e??53??49??4f??4e??0a??}
		 $hex9= {44??49??53??41??42??4c??45??45??58??54??45??4e??53??49??4f??4e??53??0a??}
		 $hex10= {44??65??6c??61??79??65??64??45??78??70??61??6e??73??69??6f??6e??0a??}
		 $hex11= {44??69??73??61??62??6c??65??55??4e??43??43??68??65??63??6b??0a??}
		 $hex12= {45??4e??41??42??4c??45??44??45??4c??41??59??45??44??45??58??50??41??4e??53??49??4f??4e??0a??}
		 $hex13= {45??6e??61??62??6c??65??45??78??74??65??6e??73??69??6f??6e??73??0a??}
		 $hex14= {46??69??6c??65??44??65??73??63??72??69??70??74??69??6f??6e??0a??}
		 $hex15= {4d??44??20??5b??64??72??69??76??65??3a??5d??70??61??74??68??0a??}
		 $hex16= {4d??69??63??72??6f??73??6f??66??74??20??43??6f??72??70??6f??72??61??74??69??6f??6e??0a??}
		 $hex17= {4d??69??73??73??69??6e??67??20??6f??70??65??72??61??6e??64??2e??0a??}
		 $hex18= {63??6f??6d??6d??61??6e??64??20??65??78??65??63??75??74??69??6f??6e??2e??0a??}
		 $hex19= {63??6f??6e??74??72??6f??6c??20??63??68??61??72??61??63??74??65??72??2e??0a??}

	condition:
		21 of them
}
